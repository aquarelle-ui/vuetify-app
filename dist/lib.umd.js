!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@aquarelle/json-form"),require("quill"),require("highlightjs"),require("ace-builds"),require("@aquarelle/vuetify-json-form"),require("vue-router"),require("vue"),require("vuetify"),require("@aquarelle/intl")):"function"==typeof define&&define.amd?define(["exports","@aquarelle/json-form","quill","highlightjs","ace-builds","@aquarelle/vuetify-json-form","vue-router","vue","vuetify","@aquarelle/intl"],t):t((e.Aquarelle=e.Aquarelle||{},e.Aquarelle.VuetifyApp={}),e.Aquarelle.JsonForm,e.Quill,e.hljs,e.ace,e.Aquarelle.VuetifyJsonForm,e.VueRouter,e.Vue,e.Vuetify,e.Aquarelle.Intl)}(this,function(e,t,i,s,n,r,o,a,l,c){"use strict";i=i&&i.hasOwnProperty("default")?i.default:i,s=s&&s.hasOwnProperty("default")?s.default:s,n=n&&n.hasOwnProperty("default")?n.default:n;var u="default"in r?r.default:r;function d(e=document.body){return!0===e?document.body:e instanceof window.Node?e:document.querySelector(e)}o=o&&o.hasOwnProperty("default")?o.default:o,a=a&&a.hasOwnProperty("default")?a.default:a,l=l&&l.hasOwnProperty("default")?l.default:l,c=c&&c.hasOwnProperty("default")?c.default:c;const h=new Map,p={inserted(e,{value:t},i){const{parentNode:s}=e,n=document.createComment("");let r=!1;!1!==t&&(s.replaceChild(n,e),d(t).appendChild(e),r=!0),h.has(e)||h.set(e,{parentNode:s,home:n,hasMovedOut:r})},componentUpdated(e,{value:t}){const{parentNode:i,home:s,hasMovedOut:n}=h.get(e);!n&&t?(i.replaceChild(s,e),d(t).appendChild(e),h.set(e,{...h.get(e),hasMovedOut:n})):n&&!1===t?(i.replaceChild(e,s),h.set(e,{...h.get(e),hasMovedOut:n})):t&&d(t).appendChild(e)},unbind(e,t){const{parentNode:i,home:s,hasMovedOut:n}=h.get(e);n&&i.replaceChild(e,s),h.delete(e)}};function g(e){e.directive("dom-portal",p)}const y={inserted:(e,t)=>document.title=t.value,update:(e,t)=>document.title=t.value};function m(e){e.directive("title",y)}const M=["red","pink","purple","deep-purple","indigo","blue","light-blue","cyan","teal","green","light-green","lime","yellow","amber","orange","deep-orange","brown","blue-grey","grey"],f=["","lighten-2","lighten-1","darken-1","darken-2","accent-2","accent-3","accent-4"],v=M.length,L=f.length;var N=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="LetterAvatar.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{class:this.avatarClass},[t("span",{class:this.textClass},[this._v(this._s(this.letter))])])},staticRenderFns:[]},0,{name:"letter-avatar",props:{text:{type:String,required:!0},lettersCount:{type:Number,default:1},toUpper:{type:Boolean,default:!0},textClass:{type:String,default:"white--text headline"},squared:{type:Boolean,default:!1}},computed:{avatarClass(){const e=this.text.charCodeAt(0),t=this.text.charCodeAt(this.text.length-1),i=["letter-avatar"];return this.squared&&i.push("squared"),i.push(M[e%v]),i.push(f[t%L]),i.join(" ").trim()},letter(){const e=this.text.substring(0,this.lettersCount);return this.toUpper?e.toUpperCase():e}}},void 0,!1);class D extends Error{constructor(e){super(e),this.name=this.constructor.name,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error(e).stack}}class w extends D{constructor(e){super(e.statusText),this._response=e}get response(){return this._response}}let j=null,x="same-origin",T={Accept:"application/json","Content-Type":"application/json"};class _{constructor(e){this._url=e}_onResponse(e){if(!e.ok)throw new w(e);return 204===e.status?e:e.json()}_resolveUrl(e){return _.resolveUrl(e)}_fetch(e,t={}){e=this._resolveUrl(e),t={method:"get",headers:T,credentials:x,...t};let i=new Request(e,t);return fetch(i).then(this._onResponse)}_send(e,t,i="post"){return e=this._resolveUrl(e),fetch(e,{method:i,body:JSON.stringify(t),headers:T,credentials:x}).then(this._onResponse)}static resolveUrl(e){return null===j?e:j+e}static setBaseUrl(e){j=e}static getBaseUrl(){return j}static setCredentials(e){x=e}static getCredentials(){return x}static setFetchHeaders(e){T=e}}const I=/^\s*\<svg(\s|\>)/i,C=/^(https?\:|data\:|\/)/i;var b=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="ImageIcon.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.isIcon?i("v-icon",e._b({style:{width:e.size+"px",height:e.size+"px"}},"v-icon",e.$attrs,!1),[e._v(e._s(e.$controlIcon(e.source)))]):e.isURL?i("img",e._b({class:{"image-icon":!0,squared:e.squared},style:{width:e.size+"px",height:e.size+"px"},attrs:{src:e.source}},"img",e.$attrs,!1)):e.letterFallback?i("letter-avatar",e._b({style:{width:e.size+"px",height:e.size+"px"},attrs:{text:e.src,squared:e.squared}},"letter-avatar",e.$attrs,!1)):e._e()},staticRenderFns:[]},0,{name:"image-icon",components:{LetterAvatar:N},props:{src:{type:String,default:""},letterFallback:{type:Boolean,default:!0},squared:{type:Boolean,default:!1},size:{type:Number,default:40}},computed:{source(){let e=this.src;if(this.isIcon)return e.substring(1);if(I.test(e))return-1===e.indexOf('xmlns="http://www.w3.org/2000/svg"')&&(e=e.replace("<svg",'<svg xmlns="http://www.w3.org/2000/svg"')),"data:image/svg+xml;base64,"+btoa(e);const t=_.getBaseUrl();return t&&e.startsWith("/")&&(e=t+e),e},isURL(){return C.test(this.source)},isIcon(){return this.src.length>0&&"@"===this.src[0]}}},void 0,!1);var A=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="ContentLoader.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this.$createElement,t=this._self._c||e;return this.loading?t("v-layout",{attrs:{"fill-height":"","justify-center":"","align-center":""}},[t("v-progress-circular",{attrs:{indeterminate:"",color:"secondary"}})],1):t("v-layout",{attrs:{column:"","fill-height":""}},[this._t("default")],2)},staticRenderFns:[]},0,{name:"content-loader",props:{loading:{type:Boolean,default:!1}}},void 0,!1),E={_items:{},get(e){return this.has(e)?this._items[e]:null},register(e,t){return this._items[e]=t,this},unregister(e){return delete this._items[e],this},has(e){return this._items.hasOwnProperty(e)}};var O=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="control.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-autocomplete",{attrs:{"error-messages":e.allErrors,label:e.$intl.translate(e.display.title),hint:e.$intl.translate(e.display.hint),placeholder:e.$intl.translate(e.display.placeholder),"prepend-icon":e.$controlIcon(e.display.prependIcon),"append-icon":e.$controlIcon(e.display.appendIcon),box:"box"===e.display.appearance,solo:"solo"===e.display.appearance,"solo-inverted":"solo-inverted"===e.display.appearance,outline:"outline"===e.display.appearance,flat:!!e.display.flat,multiple:e.config.multiple||!1,clearable:"",items:e.loadedItems,"item-value":e.getValue,"item-text":e.titleProp,"item-avatar":e.iconProp,"value-comparator":e.$equals,loading:e.loading,disabled:e.loading},scopedSlots:e._u([{key:"selection",fn:function(t){return[[i("image-icon",{attrs:{src:t.item[e.iconProp]||t.item[e.titleProp],squared:e.display.squared}}),e._v(" "),i("span",{staticClass:"ml-1 mr-1"},[e._v(e._s(t.item[e.titleProp]))])]]}},{key:"item",fn:function(t){return[i("v-list-tile-avatar",[i("image-icon",{attrs:{src:t.item[e.iconProp]||t.item[e.titleProp],squared:e.display.squared}})],1),e._v(" "),i("v-list-tile-content",[i("v-list-tile-title",[e._v("\n                "+e._s(t.item[e.titleProp])+"\n            ")]),e._v(" "),i("v-list-tile-sub-title",[e._v("\n                "+e._s(t.item[e.descriptionProp])+"\n                "),e.display.hideType?e._e():i("small",[e._v("("+e._s(t.item.behavior?t.item.type+":"+t.item.behavior:t.item.type)+")")])])],1)]}}]),model:{value:e.model[e.name],callback:function(t){e.$set(e.model,e.name,t)},expression:"model[name]"}})},staticRenderFns:[]},0,{name:"entity-type-control",mixins:[t.JsonFormElementMixin],components:{ImageIcon:b},data:()=>({loading:!0,loadedItems:[]}),created(){this.refresh()},methods:{getValue:e=>({type:e.type,behavior:e.behavior}),refresh(){this.loading=!0,this.loader&&this.loader.cached(this.config.cacheKey).then(e=>{this.loadedItems=this.translateItems(e),this.loading=!1,this.reset()})},translateItems(e){return e.map(e=>((e={...e})[this.titleProp]=this.$intl.translate(e[this.titleProp]),e[this.descriptionProp]=this.$intl.translate(e[this.descriptionProp]),e))}},computed:{loader(){return E.get(this.config.entity)},titleProp(){return this.config.titleProp||"title"},descriptionProp(){return this.config.descriptionProp||"description"},iconProp(){return this.config.iconProp||"icon"}}},void 0,!1);class S extends t.ControlParser{constructor(e,t=null,i={},s="types"){super(e),this._entity=t,this._display=i,this._cacheKey=s}getDisplay(e,t){return{...this._display,...super.getDisplay(e,t)}}getDefault(e){return e.config&&e.config.multiple?Array.isArray(e.default)?e.default:[]:e.default||void 0}getConfig(e){return{multiple:!1,entity:this._entity,cacheKey:this._cacheKey,...e.config}}getItems(e,t,i,s){return[]}parse(e,i,s){const n=super.parse(e,i,s);return n.config.multiple?t.ControlParser.setConfigUsingValidation(n.config,e.validation,["required","minItems","maxItems"]):t.ControlParser.setConfigUsingValidation(n.config,e.validation,["required"]),n}}O.install=function(e){e.component(O.name,O),t.JsonForm.addControl("entity-type",new S(O.name,null))};var k=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="control.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-autocomplete",{attrs:{"error-messages":e.allErrors,label:e.$intl.translate(e.display.title),hint:e.$intl.translate(e.display.hint),placeholder:e.$intl.translate(e.display.placeholder),"prepend-icon":e.$controlIcon(e.display.prependIcon),"append-icon":e.$controlIcon(e.display.appendIcon),box:"box"===e.display.appearance,solo:"solo"===e.display.appearance,"solo-inverted":"solo-inverted"===e.display.appearance,outline:"outline"===e.display.appearance,flat:!!e.display.flat,multiple:e.config.multiple||!1,"hide-selected":"",autocomplete:"",clearable:"",items:e.loadedItems,"item-value":e.valueProp,"item-text":e.titleProp,"value-comparator":e.$equals,loading:e.loading,disabled:e.loading},scopedSlots:e._u([{key:"selection",fn:function(t){return[[i("letter-avatar",{attrs:{text:t.item[e.titleProp]||""}}),e._v(" "),i("span",{staticClass:"ml-1 mr-1"},[e._v(e._s(t.item[e.titleProp]))])]]}},{key:"item",fn:function(t){return[i("v-list-tile-avatar",[i("letter-avatar",{attrs:{text:t.item[e.titleProp]||""}})],1),e._v(" "),i("v-list-tile-content",[i("v-list-tile-title",[e._v("\n                "+e._s(t.item[e.titleProp])+"\n            ")]),e._v(" "),e.display.hideType?i("v-list-tile-sub-title",[e._v("\n                "+e._s(t.item[e.descriptionProp]||"")+"\n            ")]):i("v-list-tile-sub-title",[e._v("\n                "+e._s(t.item.behavior?t.item.type+":"+t.item.behavior:t.item.type)+"\n            ")])],1)]}}]),model:{value:e.model[e.name],callback:function(t){e.$set(e.model,e.name,t)},expression:"model[name]"}})},staticRenderFns:[]},0,{name:"entity-instance-control",mixins:[t.JsonFormElementMixin],components:{LetterAvatar:N},data:()=>({loading:!0,loadedItems:[]}),created(){this.refresh()},methods:{refresh(){this.loading=!0,this.loader&&this.loader.cached(this.config.cacheKey).then(e=>{this.loadedItems=e.collection,this.loading=!1,this.reset()})}},computed:{loader(){return E.get(this.config.entity)},titleProp(){return this.config.titleProp||"title"},descriptionProp(){return this.config.descriptionProp||"description"},valueProp(){return this.config.valueProp||"id"}}},void 0,!1);class z extends t.ControlParser{constructor(e,t=null,i={},s={},n="instances"){super(e),this._entity=t,this._display=i,this._config=s,this._cacheKey=n}getDisplay(e,t){return{...this._display,...super.getDisplay(e,t)}}getDefault(e){return e.config&&e.config.multiple?Array.isArray(e.default)?e.default:[]:e.default||void 0}getConfig(e){return{multiple:!1,entity:this._entity,cacheKey:this._cacheKey,...this._config,...e.config}}getItems(e,t,i,s){return[]}parse(e,i,s){const n=super.parse(e,i,s);return n.config.multiple?t.ControlParser.setConfigUsingValidation(n.config,e.validation,["required","minItems","maxItems"]):t.ControlParser.setConfigUsingValidation(n.config,e.validation,["required"]),n}}k.install=function(e){e.component(k.name,k),t.JsonForm.addControl("entity-instance",new z(k.name,null))};var Y=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="AppLayout.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-app",[i("v-navigation-drawer",{attrs:{app:"",fixed:"",clipped:""},model:{value:e.leftDrawer,callback:function(t){e.leftDrawer=t},expression:"leftDrawer"}},[e._t("app-left-drawer")],2),e._v(" "),i("v-navigation-drawer",{attrs:{app:"",right:"",temporary:""},model:{value:e.rightDrawer,callback:function(t){e.rightDrawer=t},expression:"rightDrawer"}},[e._t("app-right-drawer")],2),e._v(" "),i("v-toolbar",{ref:"toolbar",attrs:{app:"",fixed:"","clipped-left":"","clipped-right":"",color:"primary",dark:""}},[i("v-toolbar-side-icon",{on:{click:function(t){t.stopPropagation(),e.leftDrawer=!e.leftDrawer}}}),e._v(" "),i("v-toolbar-title",{staticClass:"ml-0",attrs:{id:"app-title"}}),e._v(" "),i("v-spacer"),e._v(" "),e._t("app-actions",[i("div",{attrs:{id:"app-actions"}})]),e._v(" "),i("v-btn",{attrs:{icon:"",flat:""},on:{click:function(t){t.stopPropagation(),e.rightDrawer=!e.rightDrawer}}},[i("v-icon",[e._v(e._s(e.actionIcon))])],1)],2),e._v(" "),e._t("default")],2)},staticRenderFns:[]},0,{name:"app-layout",data:()=>({leftDrawer:null,rightDrawer:!1}),props:{actionIcon:{type:String,default:"apps"}}},void 0,!1);var P=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="AppMenu.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-list",e._b({attrs:{"two-line":""}},"v-list",e.$attrs,!1),[e._l(e.menus,function(t){return[i("v-subheader",[e._v(e._s(e.$intl.translate(t.title)))]),e._v(" "),e._l(t.items,function(t){return i("v-list-tile",{key:t.href,attrs:{to:t.href}},[i("v-list-tile-action",[i("v-icon",[e._v(e._s(e.$controlIcon(t.icon)))])],1),e._v(" "),i("v-list-tile-content",[i("v-list-tile-title",[e._v("\n                    "+e._s(e.$intl.translate(t.title))+"\n                ")]),e._v(" "),null!==t.description?i("v-list-tile-sub-title",[e._v("\n                    "+e._s(e.$intl.translate(t.description))+"\n                ")]):e._e()],1)],1)})]})],2)},staticRenderFns:[]},0,{name:"app-menu",props:{user:{type:Object,required:!0},app:{type:Object,required:!0},vendor:{type:String},extension:{type:String}},computed:{menus(){const e=this.app.getVendorExtension(this.vendor,this.extension);if(!e||!e.menu||0===e.menu.length)return[];const t=[];return e.menu.map(e=>{if(!this.hasPermissions(e.permissions))return;const i=[];e.items&&e.items.length>0&&e.items.map(e=>{this.hasPermissions(e.permissions)&&i.push({title:e.title||null,description:e.description||null,icon:e.icon||null,permissions:e.permissions||[],href:this.hrefPrefix+(e.href||"")})}),0!==i.length&&t.push({title:e.title||null,permissions:e.permissions||[],icon:e.icon||null,items:i})}),t},hrefPrefix(){return"/"+this.vendor+"/"+this.extension+"/"}},methods:{hasPermissions(e){return this.user.hasPermission(e)}}},void 0,!1);var $=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="AppExtensions.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-list",e._b({attrs:{"two-line":""}},"v-list",e.$attrs,!1),e._l(e.vendors,function(t){return i("v-list-group",{key:t.name,attrs:{value:e.alwaysOpen||t.name===e.currentVendor}},[i("v-list-tile",{attrs:{slot:"activator"},slot:"activator"},[i("v-list-tile-action",[i("image-icon",{attrs:{src:t.icon||e.$intl.translate(t.title)}})],1),e._v(" "),i("v-list-tile-content",[i("v-list-tile-title",[e._v("\n                    "+e._s(e.$intl.translate(t.title))+"\n                ")]),e._v(" "),i("v-list-tile-sub-title",[e._v("\n                    "+e._s(e.$intl.translate(t.description))+"\n                ")])],1)],1),e._v(" "),e._l(t.extensions,function(t){return i("v-list-tile",{key:t.href,class:e.isLinkActive(t.extHref)?["v-list__tile--active","primary--text"]:void 0,on:{click:function(i){e.goto(t.href)}}},[i("v-list-tile-action",[i("image-icon",{attrs:{src:t.icon||e.$intl.translate(t.title)}})],1),e._v(" "),i("v-list-tile-content",[i("v-list-tile-title",[e._v("\n                    "+e._s(e.$intl.translate(t.title))+"\n                ")]),e._v(" "),i("v-list-tile-sub-title",[e._v("\n                    "+e._s(e.$intl.translate(t.description))+"\n                ")])],1)],1)})],2)}))},staticRenderFns:[]},0,{components:{ImageIcon:b},name:"app-extensions",props:{currentVendor:{type:String,default:null},app:{type:Object,required:!0},alwaysOpen:{type:Boolean,default:!1}},computed:{vendors(){let e=[];const t=this.app.vendors;for(const i in t){if(!t.hasOwnProperty(i))continue;const s=t[i];if(!this.hasPermissions(s.permissions||[]))continue;const n=this.getVendorExtensions(s.name);0!==n.length&&e.push({name:s.name,title:s.title||s.name,description:s.description||null,icon:s.icon||null,extensions:n})}return e}},methods:{isLinkActive(e){return this.$route.path===e||this.$route.path.startsWith(e+"/")},goto(e){this.$router.push(e)},hasPermissions(e){return this.app.user.hasPermission(e)},getVendorExtensions(e){const t=[];return this.app.getAllVendorExtensions(e).map(e=>{if(!this.hasPermissions(e.permissions))return;if(!e.menu||0===e.menu.length)return;let i="";if(!e.menu.some(e=>!(!e.items||0===e.items.length||!this.hasPermissions(e.permissions))&&e.items.some(e=>!!this.hasPermissions(e.permissions)&&(i=e.href||"",!0))))return;let s="/"+e.vendor+"/"+e.name;const n={vendor:e.vendor,name:e.name,title:e.title,description:e.description,icon:e.icon,extHref:s,href:s+"/"+i};t.push(n)}),t}}},void 0,!1);var F=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="AppUser.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card",{attrs:{flat:""}},[i("v-container",{attrs:{fluid:"","grid-list-sm":""}},[i("v-layout",{attrs:{row:""}},[i("v-flex",[i("image-icon",{attrs:{squared:"",size:80,"letters-count":2,src:e.user.avatar||e.user.name}})],1),e._v(" "),i("v-flex",[i("div",{staticClass:"headline"},[e._v(e._s(e.user.name))]),e._v(" "),i("div",[e._v(e._s(e.user.email))]),e._v(" "),i("div",[i("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.signOut(t)}}},[e._v("Sign out")])])])],1)],1)],1)},staticRenderFns:[]},0,{name:"app-user",components:{ImageIcon:b},props:{user:{type:Object,required:!0}},methods:{signOut(){this.user.signOut().then(()=>{window.location.replace(window.location.toString().split("#")[0])})}}},void 0,!1);var U=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="AppRoot.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this.$createElement,t=this._self._c||e;return this.ready?t("router-view"):t("v-app",[t("v-container",{attrs:{fluid:"","fill-height":""}},[t("v-layout",{attrs:{"justify-center":"","align-center":""}},[t("v-flex",{staticClass:"text-xs-center"},[t("img",{staticStyle:{"max-width":"80%"},attrs:{src:this.logo}}),this._v(" "),t("v-progress-linear",{attrs:{indeterminate:""}}),this._v(" "),t("v-flex",[this._v(this._s(this.status))])],1)],1)],1)],1)},staticRenderFns:[]},0,{name:"app-root",props:{user:{type:Object,required:!0},options:{type:Object,default:()=>({firstDayOfWeek:0,language:"en"})}},data:()=>({logo:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDU2LjA3MDIiIGhlaWdodD0iMjI1LjY5MTciIHZpZXdCb3g9IjAgMCAxNDU2LjA3MDIgMjI1LjY5MTciPgogICAgPGRlZnM+CiAgICAgICAgPHN0eWxlPi5hIHtmaWxsOiAjMTk3NmQyfTwvc3R5bGU+CiAgICA8L2RlZnM+CiAgICA8dGl0bGU+QXF1YXJlbGxlPC90aXRsZT4KICAgIDxnPgogICAgICAgIDxnPgogICAgICAgICAgICA8cGF0aCBjbGFzcz0iYSIgZD0iTTgzMy4xOTI4LDU1LjA1Vjc4Ljc4NTZhNjYuNjI4NCw2Ni42Mjg0LDAsMSwwLDAsODUuNzg2NnYyMy43MzUxSDg0OC44NVY1NS4wNVpNNzgyLjIyMTksMTcyLjY1YTUwLjk3MDgsNTAuOTcwOCwwLDEsMSw1MC45NzA5LTUwLjk3MDZBNTAuOTcsNTAuOTcsMCwwLDEsNzgyLjIyMTksMTcyLjY1WiIvPgogICAgICAgICAgICA8cGF0aCBjbGFzcz0iYSIgZD0iTTU1NS40NCwxMjEuNjc5QTY2LjY2ODUsNjYuNjY4NSwwLDEsMCw1MzAuMDUxNCwxNzMuOTlsMTQuMzE3MiwxNC4zMTcxTDU1NS40NCwxNzcuMjM1OCw1NDEuMTIzLDE2Mi45MTg2QTY2LjMyMTIsNjYuMzIxMiwwLDAsMCw1NTUuNDQsMTIxLjY3OVpNNDg4LjgxMTYsMTcyLjY1YTUwLjk4NjgsNTAuOTg2OCwwLDEsMSw0MS4xNDU0LTIwLjg5NjlsLTEyLjI3NTktMTIuMjc2TDUwNi42MSwxNTAuNTQ4M2wxMi4yNzYsMTIuMjc1OUE1MC43Myw1MC43MywwLDAsMSw0ODguODExNiwxNzIuNjVaIi8+CiAgICAgICAgICAgIDxwYXRoIGNsYXNzPSJhIiBkPSJNNjg2LjUyMjksNTUuMDVWMTIxLjY3OWgtLjAzNTNhNTAuOTcwOCw1MC45NzA4LDAsMCwxLTEwMS45NDE2LDBoLS4wMzUzVjU1LjA1SDU2OC44ODg0VjEyMS42NzlhNjYuNjI4NCw2Ni42Mjg0LDAsMCwwLDEzMy4yNTY4LDBWNTUuMDVaIi8+CiAgICAgICAgICAgIDxwYXRoIGNsYXNzPSJhIiBkPSJNOTMyLjgzNjQsNTUuMDVhNjYuNjI4NCw2Ni42Mjg0LDAsMCwwLTY2LjYyODUsNjYuNjI4NHY2Ni42Mjg1SDg4MS44M1YxMjEuNjc4OGguMDM1M2E1MC45NzA3LDUwLjk3MDcsMCwwLDEsMTAxLjk0MTQsMGgxNS42NTc2QTY2LjYyODIsNjYuNjI4MiwwLDAsMCw5MzIuODM2NCw1NS4wNVoiLz4KICAgICAgICAgICAgPHBhdGggY2xhc3M9ImEiIGQ9Ik0xMDc4Ljc1LDU1LjA1NTVBNjYuNjIzNCw2Ni42MjM0LDAsMSwwLDExMzQuNjU2LDE1Ny44OTdoLTIwLjA2ODdhNTAuOTUyLDUwLjk1MiwwLDEsMSwxNS4xMzU5LTM2LjIxODFIMTA3OC43NXYxNS42NWg2NC43NjM5YTY1Ljk1MjcsNjUuOTUyNywwLDAsMCwxLjg1OTMtMTUuNjVBNjYuNjIzOCw2Ni42MjM4LDAsMCwwLDEwNzguNzUsNTUuMDU1NVoiLz4KICAgICAgICAgICAgPHBhdGggY2xhc3M9ImEiIGQ9Ik0xMzg5LjQ0Nyw1NS4wNTU1YTY2LjYyMzQsNjYuNjIzNCwwLDEsMCw1NS45MDY0LDEwMi44NDE1aC0yMC4wNjg3YTUwLjk1Miw1MC45NTIsMCwxLDEsMTUuMTM1OS0zNi4yMTgxSDEzODkuNDQ3djE1LjY1aDY0Ljc2MzlhNjUuOTUyNyw2NS45NTI3LDAsMCwwLDEuODU5My0xNS42NUE2Ni42MjM4LDY2LjYyMzgsMCwwLDAsMTM4OS40NDcsNTUuMDU1NVoiLz4KICAgICAgICAgICAgPHBhdGggY2xhc3M9ImEiIGQ9Ik0xMTc4LjM5OSwxMjEuNjc5aC0uMDM1NlY1NS4wNWgtMTUuNjIyVjEyMS42NzloMGE2Ni42MjgxLDY2LjYyODEsMCwwLDAsNjYuNjI4MSw2Ni42MjgzVjE3Mi42NUE1MC45Nyw1MC45NywwLDAsMSwxMTc4LjM5OSwxMjEuNjc5WiIvPgogICAgICAgICAgICA8cGF0aCBjbGFzcz0iYSIgZD0iTTEyNjMuODk4MSwxMjEuNjc5aC0uMDM1NlY1NS4wNUgxMjQ4LjI0VjEyMS42NzloMGE2Ni42Mjc5LDY2LjYyNzksMCwwLDAsNjYuNjI4MSw2Ni42MjgzVjE3Mi42NUE1MC45Nyw1MC45NywwLDAsMSwxMjYzLjg5ODEsMTIxLjY3OVoiLz4KICAgICAgICAgICAgPHBhdGggY2xhc3M9ImEiIGQ9Ik04MzMuMTkyOCw1NS4wNVY3OC43ODU2YTY2LjYyODQsNjYuNjI4NCwwLDEsMCwwLDg1Ljc4NjZ2MjMuNzM1MUg4NDguODVWNTUuMDVaTTc4Mi4yMjE5LDE3Mi42NWE1MC45NzA4LDUwLjk3MDgsMCwxLDEsNTAuOTcwOS01MC45NzA2QTUwLjk3LDUwLjk3LDAsMCwxLDc4Mi4yMjE5LDE3Mi42NVoiLz4KICAgICAgICAgICAgPHBhdGggY2xhc3M9ImEiIGQ9Ik0zOTAuMDUyMiw1NS4wNVY3OC43ODU2YTY2LjYyODQsNjYuNjI4NCwwLDEsMCwwLDg1Ljc4NjZ2MjMuNzM1MUg0MDUuNzFWNTUuMDVaTTMzOS4wODEzLDE3Mi42NWE1MC45NzA4LDUwLjk3MDgsMCwxLDEsNTAuOTcwOS01MC45NzA2QTUwLjk3LDUwLjk3LDAsMCwxLDMzOS4wODEzLDE3Mi42NVoiLz4KICAgICAgICAgICAgPHBhdGggY2xhc3M9ImEiIGQ9Ik01NTUuNDQsMTIxLjY3OUE2Ni42Njg1LDY2LjY2ODUsMCwxLDAsNTMwLjA1MTQsMTczLjk5bDE0LjMxNzIsMTQuMzE3MUw1NTUuNDQsMTc3LjIzNTgsNTQxLjEyMywxNjIuOTE4NkE2Ni4zMjEyLDY2LjMyMTIsMCwwLDAsNTU1LjQ0LDEyMS42NzlaTTQ4OC44MTE2LDE3Mi42NWE1MC45ODY4LDUwLjk4NjgsMCwxLDEsNDEuMTQ1NC0yMC44OTY5bC0xMi4yNzU5LTEyLjI3Nkw1MDYuNjEsMTUwLjU0ODNsMTIuMjc2LDEyLjI3NTlBNTAuNzMsNTAuNzMsMCwwLDEsNDg4LjgxMTYsMTcyLjY1WiIvPgogICAgICAgICAgICA8cGF0aCBjbGFzcz0iYSIgZD0iTTY4Ni41MjI5LDU1LjA1VjEyMS42NzloLS4wMzUzYTUwLjk3MDgsNTAuOTcwOCwwLDAsMS0xMDEuOTQxNiwwaC0uMDM1M1Y1NS4wNUg1NjguODg4NFYxMjEuNjc5YTY2LjYyODQsNjYuNjI4NCwwLDAsMCwxMzMuMjU2OCwwVjU1LjA1WiIvPgogICAgICAgICAgICA8cGF0aCBjbGFzcz0iYSIgZD0iTTkzMi44MzY0LDU1LjA1YTY2LjYyODQsNjYuNjI4NCwwLDAsMC02Ni42Mjg1LDY2LjYyODR2NjYuNjI4NUg4ODEuODNWMTIxLjY3ODhoLjAzNTNhNTAuOTcwNyw1MC45NzA3LDAsMCwxLDEwMS45NDE0LDBoMTUuNjU3NkE2Ni42MjgyLDY2LjYyODIsMCwwLDAsOTMyLjgzNjQsNTUuMDVaIi8+CiAgICAgICAgICAgIDxwYXRoIGNsYXNzPSJhIiBkPSJNMTA3OC43NSw1NS4wNTU1QTY2LjYyMzQsNjYuNjIzNCwwLDEsMCwxMTM0LjY1NiwxNTcuODk3aC0yMC4wNjg3YTUwLjk1Miw1MC45NTIsMCwxLDEsMTUuMTM1OS0zNi4yMTgxSDEwNzguNzV2MTUuNjVoNjQuNzYzOWE2NS45NTI3LDY1Ljk1MjcsMCwwLDAsMS44NTkzLTE1LjY1QTY2LjYyMzgsNjYuNjIzOCwwLDAsMCwxMDc4Ljc1LDU1LjA1NTVaIi8+CiAgICAgICAgICAgIDxwYXRoIGNsYXNzPSJhIiBkPSJNMTM4OS40NDcsNTUuMDU1NWE2Ni42MjM0LDY2LjYyMzQsMCwxLDAsNTUuOTA2NCwxMDIuODQxNWgtMjAuMDY4N2E1MC45NTIsNTAuOTUyLDAsMSwxLDE1LjEzNTktMzYuMjE4MUgxMzg5LjQ0N3YxNS42NWg2NC43NjM5YTY1Ljk1MjcsNjUuOTUyNywwLDAsMCwxLjg1OTMtMTUuNjVBNjYuNjIzOCw2Ni42MjM4LDAsMCwwLDEzODkuNDQ3LDU1LjA1NTVaIi8+CiAgICAgICAgICAgIDxwYXRoIGNsYXNzPSJhIiBkPSJNMTE3OC4zOTksMTIxLjY3OWgtLjAzNTZWNTUuMDVoLTE1LjYyMlYxMjEuNjc5aDBhNjYuNjI4MSw2Ni42MjgxLDAsMCwwLDY2LjYyODEsNjYuNjI4M1YxNzIuNjVBNTAuOTcsNTAuOTcsMCwwLDEsMTE3OC4zOTksMTIxLjY3OVoiLz4KICAgICAgICAgICAgPHBhdGggY2xhc3M9ImEiIGQ9Ik0xMjYzLjg5ODEsMTIxLjY3OWgtLjAzNTZWNTUuMDVIMTI0OC4yNFYxMjEuNjc5aDBhNjYuNjI3OSw2Ni42Mjc5LDAsMCwwLDY2LjYyODEsNjYuNjI4M1YxNzIuNjVBNTAuOTcsNTAuOTcsMCwwLDEsMTI2My44OTgxLDEyMS42NzlaIi8+CiAgICAgICAgPC9nPgogICAgICAgIDxwYXRoIGNsYXNzPSJhIiBkPSJNMjE5LjMzODksMTQ3LjEzMjFhMTA0Ljc0ODMsMTA0Ljc0ODMsMCwwLDAsMi45ODkyLTExLjQyLDExMy44MTA2LDExMy44MTA2LDAsMCwwLDIuNDIyOS0yMy4zOTZjMC0yNS43ODg0LTExLjcwNTEtMTA4LjIxLTEwNS40NjM0LTExMi4xNjM2LS4wOTA4LS4wMDQ3LS4xODE2LS4wMDc4LS4yNzI1LS4wMTI1LS4zNjA4LS4wMTQ0LS43MjEyLS4wMjg4LTEuMDg0NC0uMDQxMkMxMTYuNDE5NC4wMzkzLDExNC45MDI4LDAsMTEzLjM3NTUsMGMtLjE0MjEsMC0uMjgzMi4wMDQ2LS40MjUzLjAwNTRDODMuNTU1Ny0uMTIwOCw0Ni41NTIyLDcuMTY1OCwwLDI1LjU4MzdsLjEyNzkuMTg5NUMxMC42MjQsNDEuMjgyLDExLjE1NjIsNjAuNzM1OCw1LjQxMTYsNzguNTZBMTA0Ljg2NTQsMTA0Ljg2NTQsMCwwLDAsMi40MjI0LDg5Ljk4LDExMy44NDM4LDExMy44NDM4LDAsMCwwLDAsMTEzLjM3NTdjMCwyNS43ODgxLDExLjcwNTEsMTA4LjIxLDEwNS40NjI5LDExMi4xNjM0LjA5MDguMDA0Ni4xODIxLjAwOC4yNzI5LjAxMjRxLjU0MDYuMDIyMSwxLjA4NC4wNDFjMS41MTEzLjA2LDMuMDI4My4wOTkyLDQuNTU1Mi4wOTkyLjE0MjYsMCwuMjgzMi0uMDA0OS40MjUzLS4wMDU0LDI5LjM5NS4xMjYyLDY2LjM5ODQtNy4xNiwxMTIuOTUwNy0yNS41Nzg0bC0uMTI4NC0uMTg5NEMyMTQuMTI3LDE4NC40MSwyMTMuNTk0MiwxNjQuOTU1OCwyMTkuMzM4OSwxNDcuMTMyMVpNMzAuMTc0OCwxMzcuOTMwOWE3My4yODc5LDczLjI4NzksMCwwLDAsNC4zMTQ5LDYuNTUzNyw3Ni4yODc4LDc2LjI4NzgsMCwwLDAsNTQuNzQ5MSwzMC44MTQ1LDc4LjM3NTMsNzguMzc1MywwLDAsMCwxNi4xOTg3LS4yOWwyLjAwNTktLjI2MjdjLjY3ODItLjEwODQsMS4zODIzLS4yNjUxLDIuMDcxMi0uMzk4OWw0LjE0NzUtLjg2ODZjMS4zNzQ1LS4zMTg0LDIuNzE0OS0uOCw0LjA2ODktMS4yMDcxYTM1LjQ1NTUsMzUuNDU1NSwwLDAsMCw0LjAwMTktMS40MDkybDMuODk0NS0xLjY5NzdjLjMyMTgtLjE0NjUuNjQ4NS0uMjgyMi45NjU0LS40Mzg1bC45MzExLS41MSwxLjg1Ni0xLjAyODksMS44NDcyLTEuMDQxOS45MTk0LS41MjU5Ljg3NS0uNTk3MmMxLjE2Ny0uNzk1NCwyLjMyMDgtMS42MTA4LDMuNDY4Mi0yLjQzbC44NTg0LS42MTU3LjgwODYtLjY4MDcsMS42MDctMS4zNzIsMS41OTUyLTEuMzgxNC43OTMtLjY5NDMuNzM2My0uNzU0NCwyLjkxMzEtMy4wNDI1LjcxNDgtLjc3LjY1NDgtLjgyMzIsMS4zLTEuNjUxOWE2My4wNyw2My4wNywwLDAsMCwxMi44OTM2LTMwLjM5NzVjLjA1MzctLjM0MTMuMTE3Ni0uNjgwNi4xNjA2LTEuMDIyOWwuMDgyNS0xLjAzNDIuMTQ2LTIuMDY3OS4xMjg5LTIuMDY0NC4wNi0xLjAzYy4wMDI5LS4zNDQyLS4wMTQyLS42ODg1LS4wMjEtMS4wMzIyYTU5LjM3MjIsNTkuMzcyMiwwLDAsMC0uNTYzNS04LjE5NjNjLS4yMDQxLTEuMzU3OS0uMzU3NC0yLjY4NjUtLjYyNS00LjA1MzJMMTU5LjcyLDk1Ljc1NjFjLS4zMzY5LTEuMzc3OS0uODkzLTIuNzA1Ni0xLjM1NTktNC4wNDQ0LS4yNTMtLjY2NDEtLjQ2ODMtMS4zMzk0LS43NTkzLTEuOTg2NGwtLjkxLTEuOTI1N2E0OC43MTcxLDQ4LjcxNzEsMCwwLDAtOS41OTYyLTEzLjc1MDUsNTAuNTI5LDUwLjUyOSwwLDAsMC0xMy4yNjE3LTkuNzAzNiw0Ny44OTY0LDQ3Ljg5NjQsMCwwLDAtMzEuMTEtNC4xNzM5LDM4Ljc1MjcsMzguNzUyNywwLDAsMC0xNC40NjkzLDYuMTE2MkEzNi4yNzQ4LDM2LjI3NDgsMCwwLDAsNzcuOTAyOCw3Ny4zNTQyYTM0LjIxMywzNC4yMTMsMCwwLDAtNC43LDEzLjY4MjIsMzAuODMzNSwzMC44MzM1LDAsMCwwLDEuNDcxMiwxMy42MjMsMzMuNzQwOSwzMy43NDA5LDAsMCwxLDIuOTIwOS0xMi40NjUzLDMwLjcyNDQsMzAuNzI0NCwwLDAsMSw2LjkxNDEtOS43MTI0LDI4LjYwNzIsMjguNjA3MiwwLDAsMSw5LjQ2MTktNS45MjkyLDI2LjY5OSwyNi42OTksMCwwLDEsMTAuNDIzOC0xLjczMTVjLjkxMDcuMDY2LDEuODA3Mi4wMTQyLDIuNjk5My4xMTY3bDIuNjQ4OS4zNDA5YTMzLjAyNTUsMzMuMDI1NSwwLDAsMSw1LjA3NzYsMS4zNDQyLDMxLjg2MzQsMzEuODYzNCwwLDAsMSw5LjAwOTMsNC43MTI5LDM0LjUyNDYsMzQuNTI0NiwwLDAsMSw2Ljg2NjcsNy4wMzEyLDI4Ljk2NTQsMjguOTY1NCwwLDAsMSw0LjE4Niw4LjQ5MzdsLjM2MjgsMS4xMDU1YS4zOTcyLjM5NzIsMCwwLDEsLjAxMTcuMDQzMWwuNDc1NiwyLjIzMzJhNi4yODgxLDYuMjg4MSwwLDAsMSwuMjA5LDEuMTM3MnEuMTE3MiwxLjE2LjI2ODYsMi4yOTc5Yy4wNTQyLjc5ODMuMDI2OCwxLjY2MjYuMDU2NiwyLjQ4MjlhMzcuNDMsMzcuNDMsMCwwLDEtLjE5MTQsNC45MzI2Yy0uMDE1MS4yMDM2LS4wMTkuNDA4Mi0uMDQxNS42MTA5bC0uMTE0OC42MDQtLjIxODcsMS4yMDQ2LS4yMDE3LDEuMjAxMS0uMDkxMy42Yy0uMDQ0OS4xOTczLS4xMDkzLjM5MTYtLjE2MjYuNTg3NGEzNS4wNywzNS4wNywwLDAsMS0xLjQzNjUsNC42MjIxbC0uNDIyNCwxLjEyODRhNi41MDQ5LDYuNTA0OSwwLDAsMS0uNDYsMS4xMTA5bC0xLjA1MDgsMi4xNjNhMTcuMTgwOCwxNy4xODA4LDAsMCwxLTEuMTk1OCwyLjA3NzdsLS42MTcyLDEuMDI0NGE2Ljc2ODcsNi43Njg3LDAsMCwxLS42NTg3Ljk5NTYsMzQuOTg0NywzNC45ODQ3LDAsMCwxLTIuOTU5NCwzLjczbC0uNzg1Ny44ODg2LS4zODgyLjQ0NzMtLjQ0MDkuMzk4Yy0uNTg3NC41My0xLjE1NzcsMS4wNzIyLTEuNzI1MSwxLjYxNzFsLS40MjMzLjQxMDctLjQ3MjcuMzU0LS45MzY1LjcxNDgtLjkyNDguNzI1MS0uNDU5NS4zNjUzLS41MDI0LjMwNTFjLS42Njg1LjQwODMtMS4zMy44MjA4LTEuOTc4NSwxLjI1M2wtLjQ4NjQuMzIzNy0uNTI1NC4yNTc4LTEuMDQyOS41MjQ0LTEuMDM0Mi41MzY3LS41MTQyLjI3MzRjLS4xNzcyLjA3OTEtLjM2MzcuMTM4Mi0uNTQ0NC4yMDk1cS0xLjA5Mi40MDkzLTIuMTY4Ljg0NjJhMTYuMjUzNywxNi4yNTM3LDAsMCwxLTIuMjE1OC43MDQ1Yy0uNzUxNS4xOTU0LTEuNDc0Ni40ODMtMi4yNC42M2wtMi4zMDEzLjQxMzFjLS4zODcyLjA2OTQtLjc1MjkuMTYwNy0xLjE1NjMuMjE4M2wtMS4yNTc4LjEzMThhNTAuNzYwNiw1MC43NjA2LDAsMCwxLTI5LjIyMTYtNS41MDU4LDUyLjA2NjksNTIuMDY2OSwwLDAsMS0yNS41MTY2LTMwLjY4MzJsLS43MTc4LTIuNTE5NWMtLjE5MjktLjg1ODQtLjQxNDYtMS42OTM4LS42MDExLTIuNTc1N2wtLjQ5NTYtMi43MjdjLS4xNjYtLjkxMTEtLjI1LTEuODMtLjM5MTYtMi43NDcxYTc0Ljg5LDc0Ljg5LDAsMCwxLS41Ni0xMS4xNHEuMDI5MS0xLjA3MDcuMDkxNC0yLjE0MzFDNDYuMDYxNiw1OC41MDYyLDY1LjM3OTIsMzYuMjgzLDkxLjMsMjkuNDc4OGE4Ny4wNTczLDg3LjA1NzMsMCwwLDEsNjEuNTU1OSw2LjY1MDYsODYuNzE2LDg2LjcxNiwwLDAsMSw0NS4yNDQ1LDc1LjA0MTVjLjYwOTQsNDcuMDg1Ny0zNi45OTI4LDg2LjQyNzEtODQuMDYxMyw4Ny44Mzc1YTg2LjQ1ODMsODYuNDU4MywwLDAsMS00Mi4xNDQyLTkuNDQ2MUE4Ni45NDg5LDg2Ljk0ODksMCwwLDEsMzAuMTc0OCwxMzcuOTMwOVoiLz4KICAgIDwvZz4KPC9zdmc+",status:null,ready:!1}),created(){this.status="Initialising...",this.user.refresh().then(()=>{this.status="Loading locale...";const e=this.options;this.$intl.firstDayOfWeek=e.firstDayOfWeek||0,this.$intl.language=e.language||"en"}).then(()=>{this.status="Enjoy!",this.$nextTick(()=>{this.ready=!0})})}},void 0,!1);var q=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="AppToolbar.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[i("span",{directives:[{name:"dom-portal",rawName:"v-dom-portal",value:e.titleSelector,expression:"titleSelector"}]},[e.showBack?i("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.back.length>0,expression:"back.length > 0"}],staticClass:"ml-0 mr-0",attrs:{exact:"",small:"",icon:"",to:e.back}},[i("v-icon",[e._v("arrow_back")])],1):e._e(),e._v("\n        "+e._s(e.title)+"\n    ")],1),e._v(" "),i("div",{directives:[{name:"dom-portal",rawName:"v-dom-portal",value:e.toolbarSelector,expression:"toolbarSelector"}]},[e._t("default")],2)])},staticRenderFns:[]},0,{name:"app-toolbar",props:{title:{type:String,default:""},back:{type:String,default:""},id:{type:String,default:"app-toolbar"},showBack:{type:Boolean,default:!0}},data:()=>({titleSelector:"#app-title",toolbarSelector:"#app-actions"}),created(){this.updatePageTitle()},beforeDestroy(){document.title===this.title&&this.updatePageTitle("")},watch:{title(e){this.updatePageTitle(e)}},methods:{updatePageTitle(e=this.title){document.title=e}}},void 0,!1);var R=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="AppNotifier.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-snackbar",e._b({attrs:{color:e.type,timeout:e.timeout,vertical:e.vertical,"multi-line":e.multiLine},model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},"v-snackbar",e.position,!1),[e._t("default",[e._v("\n        "+e._s(e.message)+"\n    ")],{message:e.message}),e._v(" "),e._t("actions",[i("v-btn",{attrs:{icon:"",flat:""},nativeOn:{click:function(t){t.stopPropagation(),e.hide()}}},[i("v-icon",[e._v("close")])],1)])],2)},staticRenderFns:[]},0,{props:{multiLine:{type:Boolean,default:!1},vertical:{type:Boolean,default:!1},position:{type:Object,default:()=>({bottom:!0})}},data:()=>({type:"",snackbar:!1,message:null,timeout:3e3}),methods:{showInfo(e,t=3e3){this.show("info",e,t)},showSuccess(e,t=3e3){this.show("success",e,t)},showError(e,t=3e3){this.show("error",e,t)},show(e,t,i=3e3){this.snackbar=!1,this.$nextTick(()=>{this.type=e,this.timeout=i,this.message=t,this.snackbar=!0})},hide(){this.snackbar=!1}}},void 0,!1);var Q=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="AppPage.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-flex",{attrs:{grow:""}},[i("app-toolbar",{attrs:{title:e.title,back:e.back,"show-back":e.showBack}},[e._t("toolbar")],2),e._v(" "),e.loading?i("v-layout",{attrs:{"fill-height":"","justify-center":"","align-center":""}},[i("v-progress-circular",{attrs:{indeterminate:"",color:"secondary"}})],1):e._t("default"),e._v(" "),i("app-notifier",{ref:"notifier"}),e._v(" "),i("v-dialog",{attrs:{lazy:"",persistent:"","max-width":"320"},model:{value:e.showLogin,callback:function(t){e.showLogin=t},expression:"showLogin"}},[i("v-card",[i("v-card-title",{staticClass:"headline"},[e._v("You are not signed in")]),e._v(" "),i("v-card-text",[i("v-text-field",{attrs:{disabled:e.processingLogin,rules:e.emailRules,label:"E-mail",type:"email","prepend-icon":"email"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),e._v(" "),i("v-text-field",{attrs:{disabled:e.processingLogin,rules:e.passRules,label:"Password",type:"password","prepend-icon":"lock"},model:{value:e.pass,callback:function(t){e.pass=t},expression:"pass"}})],1),e._v(" "),i("v-card-actions",[i("span",{directives:[{name:"show",rawName:"v-show",value:e.loginError,expression:"loginError"}],staticClass:"red--text"},[i("v-icon",{attrs:{color:"red"}},[e._v("error")]),e._v("Sign in failed\n                ")],1),e._v(" "),i("v-spacer"),e._v(" "),i("v-btn",{attrs:{flat:"",disabled:e.processingLogin||!e.canLogin,loading:e.processingLogin},on:{click:function(t){t.stopPropagation(),e.tryLogin(e.email,e.pass)}}},[e._v("\n                    Sign in "),i("v-icon",[e._v("navigate_next")])],1)],1)],1)],1)],2)},staticRenderFns:[]},0,{name:"app-page",components:{AppToolbar:q,AppNotifier:R},props:{title:{type:String,default:""},back:{type:String,default:""},loading:{type:Boolean,default:!1},showBack:{type:Boolean,default:!1}},data:()=>({showLogin:!1,processingLogin:!1,loginCallback:null,loginError:!1,email:"",emailRules:[e=>!!e||"E-mail is required",e=>/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,32})+$/.test(e)||"E-mail must be valid"],pass:"",passRules:[e=>!!e||"Password is required",e=>e.length>=6||"Minimum 6 chars"]}),computed:{notifier(){return this.$refs.notifier},canLogin(){return this.emailRules.every(e=>!0===e(this.email))&&this.passRules.every(e=>!0===e(this.pass))}},methods:{notify(e,t,i=3e3){this.notifier.show(e,t,i)},doLogin(e){this.processingLogin=!1,this.loginCallback=e||null,this.email=this.$user.email||"",this.pass="",this.showLogin=!0},tryLogin(e,t){this.canLogin&&(this.processingLogin=!0,this.loginError=!1,this.$user.signIn(e,t).then(()=>{this.processingLogin=!1,this.showLogin=!1;const e=this.loginCallback;this.loginCallback=null,"function"==typeof e&&this.$nextTick(e)}).catch(e=>{this.processingLogin=!1,this.loginError=!0}))}}},void 0,!1);var B=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="AppDashboard.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-app",[i("v-card",{attrs:{flat:""}},[i("v-toolbar",{attrs:{color:"primary",dark:""}},[i("v-toolbar-title",[e._v("Welcome to Aquarelle")]),e._v(" "),i("v-spacer"),e._v(" "),i("v-menu",{attrs:{"offset-x":"","max-width":"320"}},[i("v-btn",{attrs:{slot:"activator",icon:""},slot:"activator"},[i("v-icon",[e._v("person")])],1),e._v(" "),i("app-user",{staticStyle:{width:"320px"},attrs:{user:e.app.user}})],1)],1),e._v(" "),i("app-extensions",{attrs:{app:e.app,"always-open":""}})],1)],1)},staticRenderFns:[]},0,{name:"app-dashboard",components:{ImageIcon:b,AppUser:F,AppExtensions:$},props:{app:{type:Object,required:!0}},methods:{vendors(){let e=[];const t=this.app.getAllVendors();for(const i in t){if(!t.hasOwnProperty(i))continue;const s=t[i];this.hasPermissions(s.permissions||[])&&(this.hasExtPermissions(s.name)&&e.push({name:s.name,title:s.title||s.name,description:s.description||null,icon:s.icon||null,url:s.url,extensions:this.app.getAllVendorExtensions(s.name)}))}return e},hasPermissions(e){return this.app.user.hasPermission(e)},hasExtPermissions(e){return this.app.getAllVendorExtensions(e).map(e=>{if(this.hasPermissions(e.permissions))return 0===e.menu.length||e.menu.some(e=>!!this.hasPermissions(e.permissions)&&e.items.some(e=>this.hasPermissions(e.permissions)))})}}},void 0,!1);var V=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="AppExtensionRoute.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("app-layout",{ref:"layout"},[i("app-menu",{attrs:{slot:"app-left-drawer",user:e.appInfo.user,app:e.appInfo.app,vendor:e.appInfo.vendor,extension:e.appInfo.extension},slot:"app-left-drawer"}),e._v(" "),i("template",{slot:"app-right-drawer"},[i("app-user",{attrs:{user:e.appInfo.user}}),e._v(" "),i("app-extensions",{attrs:{user:e.appInfo.user,app:e.appInfo.app,"current-vendor":e.appInfo.vendor}})],1),e._v(" "),i("v-content",[i("v-layout",{style:{height:e.contentHeight}},[i("router-view")],1)],1)],2)},staticRenderFns:[]},0,{name:"app-extension-route",components:{AppMenu:P,AppExtensions:$,AppUser:F,AppLayout:Y},data:()=>({contentHeight:"100%"}),props:{appInfo:{type:Object,required:!0}},watch:{"$vuetify.breakpoint.height"(e){this.refreshToolbarHeight(e)}},mounted(){this.refreshToolbarHeight(this.$vuetify.breakpoint.height)},methods:{refreshToolbarHeight(e){const t=this.$refs.layout;t&&t.$refs.toolbar?this.contentHeight=e-t.$refs.toolbar.computedHeight:this.contentHeight=e}}},void 0,!1),H={methods:{entityLoader:e=>E.get(e),entityTypes(e,t=!0){const i=this.entityLoader(e);let s=null;return s=t?i.cached("types"):i.getTypes()},entityType(e,t,i=null,s=!0,n="type",r="behavior"){return this.entityTypes(e,s).then(e=>this.entityTypeFromList(e,t,i,n,r))},entityTypeFields(e,t,i="fields",s=[],n="type",r="behavior",o=!0){let a=null;return"object"==typeof t&&(a=t[r]||null,t=t[n]),this.entityType(e,t,a,o,n,r).then(e=>e[i]||s).catch(()=>s)},entityTypeFromList(e,t,i=null,s="type",n="behavior"){if(!e)return null;for(let r=0;r<e.length;r++)if(e[r][s]===t){if(null==i)return e[r];if(e[r][n]===i)return e[r]}return null}}};class K extends _{create(e){return this._sendData(e)}getAll(e){let t=this._url;return e&&(t+="?"+new URLSearchParams(e).toString()),this._fetch(t)}get(e){return this._fetch(this._url+"/"+e)}update(e,t){return this._sendData(t,e)}delete(e){let t=this._url+"/"+e;return this._fetch(t,{method:"delete"})}_sendData(e,t,i=""){let s=t?this._url+"/"+t:this._url;return this._send(s+i,e,t?"put":"post")}}class G extends K{constructor(e,t=!0){super(e),this._hasTypes=t}hasTypes(){return this._hasTypes}getTypes(){return this._hasTypes?this._fetch(this._url+"/types").then(e=>e.collection):null}}class W extends G{constructor(e){super(e,!1)}whoAmI(){return this._fetch(this._url+"/whoami")}signOut(e=""){return this._send(this._url+"/signout",{key:e},"post")}signIn(e,t){return this._send(this._url+"/signin",{email:e,password:t},"post")}}function J(e,t){return["id","name","email","avatar","roles","permissions","isAdmin","signOutKey"].map(i=>{e[i]=t[i]}),e}var Z={id:null,name:"Admin",email:"admin@example.com",avatar:null,isAdmin:!0,permissions:[],roles:[],signOutKey:"",loader:new W("/api/aquarelle/users/users"),setLoaderUrl(e){this.loader=new W(e)},hasPermission(e){if(!1===e)return this.isAdmin;if(this.isAdmin||!e)return!0;if(Array.isArray(e)){if(0===e.length)return!0}else e=[e];return 0!==this.permissions.length&&e.every(e=>this.permissions.indexOf(e)>=0)},refresh(){return this.loader.whoAmI().then(e=>J(this,e))},signOut(){return this.loader.signOut(this.signOutKey).then(()=>(this.id=null,this.name=null,this.email=null,this.avatar=null,this.isAdmin=!1,this.permissions=[],this.roles=[],this.signOutKey="",!0))},signIn(e,t){return this.loader.signIn(e,t).then(e=>J(this,e))}};function X(e,t,i){e.meta&&e.meta.permissions&&!Z.hasPermission(e.meta.permissions)?i(!1):i()}function ee(e,t=[]){return e.meta||(e.meta={}),e.component||(e.component={template:"<router-view></router-view>"}),e.beforeEnter=X,e.meta.permissions=t,e}function te(e,t="onRouteLeave"){if(!e||"object"!=typeof e)return!0;if(Array.isArray(e)){for(let t=0;t<e.length;t++)if(!1===te(e[t]))return!1;return!0}return"function"!=typeof e[t]||e[t](te)}var ie={beforeRouteLeave(e,t,i){return this.$refs.page&&!0===this.$refs.page.showLogin?(i(!1),!1):!1===te(this)?(i(!1),!1):!1===te(this.$refs.form)?(i(!1),!1):(i(),!0)}},se={props:{filterArgs:{type:[Object,Function],default:null}},data(){let e=this.$route.query.page;e=e?parseInt(e):1,(isNaN(e)||e<1)&&(e=1);let t={...this.$route.query};return delete t.page,{page:e,queryFilters:t}},watch:{page(e){const t=this.$route.query.page||1;if(e<=1){if(t<=1)return}else if(t==e)return;this.changeRouterQuery(this.queryFilters,e)},queryFilters(e){this.changeRouterQuery(e,this.page)}},computed:{listPage(){if(!this.$route.query)return 1;let e=this.$route.query.page||null;return null==e?1:(e=parseInt(e),isNaN(e)||e<1?1:e)},filters(){let e={};return this.$route&&this.$route.query&&Object.assign(e,this.$clone(this.$route.query)),delete e.page,e=this.clearFilters(e),this.filterArgs&&(null==e&&(e={}),"function"==typeof this.filterArgs?Object.assign(e,this.filterArgs(this.$route)):Object.assign(e,this.filterArgs)),e}},methods:{changeRouterQuery(e=null,t=1){let i=null;e&&(i={...e}),t&&t>1&&(null==i?i={page:t}:i.page=t),this.$router.push({query:i})},clearFilters(e){if(null==e||"object"!=typeof e)return e;const t=Object.keys(e);return 0===t.length?null:(t.map(t=>{if(null==e[t]||""===e[t])return void delete e[t];const i=typeof e[t];return"string"===i?(e[t]=e[t].trim(),void(""===e[t]&&delete e[t])):"number"!==i?Array.isArray(e[t])?(e[t]=e[t].map(this.clearFilters(e[t])).filter(Boolean),void(0===e[t].length&&delete e[t])):void("object"===i?(e[t]=this.clearFilters(e[t]),0===Object.keys(e[t]).length&&delete e[t]):delete e[t]):void(!isNaN(e[t])&&isFinite(e[t])||delete e[t])}),0===Object.keys(e).length?null:e)},onItemDeleted(e){0===e.list.length&&this.page>1&&this.page--}}},ne={computed:{notifier(){return this.$refs.page.notifier}}},re={methods:{parseErrorObject(e,t=null){if(e instanceof w){const t=e.response;switch(t.statusCode){case 401:return{text:"You are not logged in",key:null};case 403:return{text:"Permission denied",key:null};case 404:return{text:"Entity no longer exists",key:null};case 422:return t.json().then(e=>e.errors?e.errors[0]:null).then(e=>({text:"Invalid data",key:null}));case 500:return t.json().then(e=>e.error).then(e=>({text:"Internal Server Error: {message}",key:null,params:{message:e||"Unexpected Error"}}))}}return null}}},oe={methods:{doLogin(e){this.$refs.page&&this.$refs.page.doLogin(e)}}},ae={computed:{formOptions(){return{language:this.$intl.language,firstDayOfWeek:this.$intl.firstDayOfWeek||0,rtl:this.$intl.rtl}}}};var le=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="EntityCreateForm.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("app-page",{ref:"page",attrs:{title:e.$intl.translate(e.title),back:e.back,loading:e.loading}},[e.loaderError?i("div",[e._v("\n        Error! There is no such entity "+e._s(e.entity)+"\n    ")]):i("stepper-form",{ref:"form",attrs:{processing:e.processing,items:e.parsedSteps,"next-button-text":e.nextButtonText,"finish-button-text":e.finishButtonText,"fill-height":e.fillHeight,options:e.formOptions},on:{input:function(t){e.onSubmit(t)}},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)},staticRenderFns:[]},0,{components:{AppPage:Q},mixins:[H,ie,ne,re,oe,ae],props:{title:{type:[String,Object],required:!0},back:{type:String,default:"../"},errors:{type:Object,required:!1},errorHandler:{type:Function,required:!1},entity:{type:String,required:!0},steps:{type:Array,required:!0},initialModelData:{type:[Function,Object],required:!1},preProcessModelData:{type:[Function,Array],required:!1},extraModelData:{type:Object,required:!1},saveHandler:{type:Function,required:!1},loaderMethod:{type:String,default:"create"},redirectPath:{type:[String,Function],default:"list.html"},nextButtonText:{type:[String,Object],required:!1},finishButtonText:{type:[String,Object],required:!1},fillHeight:{type:Boolean,default:!0},afterSave:{type:Function,default:null}},data:()=>({parsedSteps:null,loading:!0,loaderError:!1,model:{},processing:!1}),created(){if(!this.loader)return this.loading=!1,void(this.loaderError=!0);this.initialModelData&&("function"==typeof this.initialModelData?this.model=this.initialModelData(this):this.model={...this.initialModelData});const e=(e,t,i=!0)=>{i&&(e={...e});let s=e[t];return e[t]=((e,t,i)=>s(e,t,i,this)),e},t=e=>(e={entity:this.entity,field:"_entity_type",prop:"fields",typeProp:"type",behaviorProp:"behavior",fallback:[],...e},t=>this.entityTypeFields(e.entity,t[e.field],e.prop,e.fallback,e.typeProp,e.behaviorProp));this.parsedSteps=this.steps.map(i=>{if("function"!=typeof i.items){let s=!0;return i.items&&"object"==typeof i.items&&!Array.isArray(i.items)&&(s=!1,(i={...i}).items=t(i.items)),"function"!=typeof i.callback?i:e(i,"callback",s)}return"function"!=typeof i.callback?e(i,"items"):(i=e(i,"items"),e(i,"callback",!1))}),this.loading=!1},computed:{loader(){return this.entityLoader(this.entity)}},methods:{onSubmit(e){this.processing=!0;let t=this.$clone(e);if(this.extraModelData&&(t={...t,...this.extraModelData}),this.preProcessModelData)if(Array.isArray(this.preProcessModelData))for(let e in t)t.hasOwnProperty(e)&&-1===this.preProcessModelData.indexOf(e)&&delete t[e];else t=this.preProcessModelData(t,this);(this.saveHandler?this.saveHandler(this.loader,t,this.entity):this.loader[this.loaderMethod](t)).then(e=>{this.processing=!1,this.afterSave&&this.afterSave(t,e,this);let i=this.redirectPath;i="function"==typeof i?i(e,t):i.replace("{id}",e.id),this.$nextTick(()=>this.$router.push(i))}).catch(t=>{if(t.response&&401===t.response.status)this.doLogin(()=>this.onSubmit(e));else{if(this.errorHandler){let e=this.errorHandler(t,this);null!=e&&(t=e)}else t=this.parseErrorObject(t,this.errors);null==t&&(t={text:"Cannot create entity "+this.entity,key:null}),"function"==typeof t.then?t.then(e=>{this.notifier.showError(this.$intl.translate(e)),this.processing=!1}):(this.notifier.showError(this.$intl.translate(t)),this.processing=!1)}})}}},void 0,!1);var ce=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="EntityEditForm.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("app-page",{ref:"page",attrs:{title:e.$intl.translate(e.title),back:e.back,loading:e.loading}},[e.loaderError?i("div",[e._v("\n        Error! Cannot load "+e._s(e.entity)+":"+e._s(e.id)+"\n    ")]):[e.contextActions&&e.contextActions.length?i("template",{slot:"toolbar"},[i("v-menu",{attrs:{"offset-y":""}},[i("v-btn",{attrs:{slot:"activator",icon:""},slot:"activator"},[i("v-icon",[e._v(e._s(e.$controlIcon(e.contextIcon)))])],1),e._v(" "),i("v-list",e._l(e.contextActions,function(t){return i("v-list-tile",{key:e.$uniqueObjectId(t),attrs:{disabled:e.isContextItemDisabled(t)},on:{click:function(i){e.contextItemAction(t)}}},[i("v-list-tile-avatar",[i("v-icon",[e._v(e._s(e.$controlIcon(t.icon||"")))])],1),e._v(" "),i("v-list-tile-content",[i("v-list-tile-title",[e._v("\n                                "+e._s(e.$intl.translate(t.title))+"\n                            ")])],1),e._v(" "),i("v-list-tile-action",[e._v(" ")])],1)}))],1)],1):e._e(),e._v(" "),i("block-form",{ref:"form",attrs:{"fill-height":e.fillHeight,processing:e.processing,title:e.instanceTitle,items:e.parsedFields,"submit-button":e.submitButtonText,options:e.formOptions},on:{submit:function(t){e.onSubmit(t)}},model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})]],2)},staticRenderFns:[]},0,{components:{AppPage:Q},mixins:[H,ie,ne,re,oe,ae],props:{title:{type:[String,Object],required:!0},back:{type:String,default:"../"},errors:{type:Object,required:!1},errorHandler:{type:Function,required:!1},entity:{type:String,required:!0},id:{type:String,required:!0},fields:{type:[String,Array,Function],default:null},modelFieldName:{type:String,default:"settings"},preProcessModelData:{type:[Function,Array],required:!1},extraModelData:{type:Object,required:!1},saveHandler:{type:Function,required:!1},loaderMethod:{type:String,default:"update"},redirectPath:{type:[String,Function],required:!1},submitButtonText:{type:[String,Object],default:"Save"},successMessage:{type:[String,Object],default:"Saved"},fillHeight:{type:Boolean,default:!0},titleKey:{type:[String,Function],default:"title"},contextActions:{type:Array,default:null},contextIcon:{type:String,default:"edit"},afterSave:{type:Function,default:null}},data:()=>({parsedFields:null,loading:!0,loaderError:!1,model:{},processing:!1,instance:null}),created(){if(!this.loader)return this.loading=!1,void(this.loaderError=!0);this.onInit()},watch:{id(){this.loading=!0,this.instance=null,this.$nextTick(()=>{this.model=null,this.parsedFields=null,this.onInit()})}},computed:{loader(){return this.entityLoader(this.entity)},instanceTitle(){return this.instance?"function"==typeof this.titleKey?this.titleKey(this.instance,this)||"":this.instance[this.titleKey]||"":""}},methods:{onInit(){const e=(e,t)=>{this.model=null==t?e:e[t]};this.loader.get(this.id).then(t=>{this.instance=t,e(t,this.modelFieldName);const i=this.parseFormFields(this.fields,t);i instanceof Promise?i.then(e=>{this.parsedFields=e,this.loading=!1}):(this.parsedFields=i,this.loading=!1)}).catch(e=>{e.response&&401===e.response.status?this.doLogin(()=>this.onInit()):(this.loaderError=!0,this.loading=!1)})},contextItemAction(e){return!this.isContextItemDisabled(e)&&(!(!e.action||"function"!=typeof e.action)&&e.action(this,e))},isContextItemDisabled(e){return!!e.hasOwnProperty("disabled")&&("boolean"==typeof e.disabled?e.disabled:Array.isArray(e.disabled)?!this.$user.hasPermission(e.disabled):"function"==typeof e.disabled&&e.disabled(this,e))},parseFormFields(e,t){if(Array.isArray(e))return e;if("function"==typeof e)return e(t,this);e?"string"==typeof e&&(e={prop:e}):e={prop:"fields"};let i=null;return i=null==(e={prop:"fields",typeProp:"type",behaviorProp:"behavior",...e}).behaviorProp?t[e.typeProp]:{[e.typeProp]:t[e.typeProp],[e.behaviorProp]:t[e.behaviorProp]},this.entityTypeFields(this.entity,i,e.prop,[],this.typeProp,this.behaviorProp)},onSubmit(e){this.processing=!0;let t=this.$clone(e);if(this.modelFieldName&&(t={[this.modelFieldName]:t}),this.preProcessModelData)if(Array.isArray(this.preProcessModelData))for(let e in t)t.hasOwnProperty(e)&&-1===this.preProcessModelData.indexOf(e)&&delete t[e];else t=this.preProcessModelData(t);this.extraModelData&&(t={...t,...this.extraModelData}),(this.saveHandler?this.saveHandler(this.loader,this.id,t,this.entity):this.loader[this.loaderMethod](this.id,t)).then(e=>{this.processing=!1,this.afterSave&&this.afterSave(t,e,this);let i=this.redirectPath;i?(i="function"==typeof i?i(e,t):i.replace("{id}",e.id),this.$nextTick(()=>this.$router.push(i))):this.notifier.showSuccess(this.$intl.translate(this.successMessage))}).catch(t=>{if(t.response&&401===t.response.status)this.doLogin(()=>this.onSubmit(e));else{if(this.errorHandler){let e=this.errorHandler(t,this);null!=e&&(t=e)}else t=this.parseErrorObject(t,this.errors);null==t&&(t={text:"Cannot save entity "+this.entity,key:null}),"function"==typeof t.then?t.then(e=>{this.notifier.showError(this.$intl.translate(e)),this.processing=!1}):(this.notifier.showError(this.$intl.translate(t)),this.processing=!1)}})}}},void 0,!1);var ue=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="EntityListTemplate.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.ready&&e.items.length>0?i("v-flex",{attrs:{"align-center":""}},[i("v-list",e._b({},"v-list",e.$attrs,!1),[e._l(e.items,function(t,i){return e._t("item",null,{item:t,type:e.getItemType(t),index:i,itemList:e.items})})],2),e._v(" "),e._t("default")],2):i("v-container",{attrs:{fluid:"","fill-height":""}},[i("v-layout",{attrs:{column:"","justify-center":"","align-center":""}},[e.ready?[e._t("empty",[e._v("\n                "+e._s(e.$intl.translate(this.emptyText))+"\n            ")]),e._v(" "),e._t("default")]:i("v-progress-circular",{attrs:{indeterminate:"",color:"secondary"}})],2)],1)},staticRenderFns:[]},0,{name:"entity-list-template",mixins:[H],props:{emptyText:{type:[Object,String],default:()=>({text:"No items to display",key:"common.emptyList"})},loader:{type:[Object,String],required:!0},handler:{type:Function,default:null},filterArgs:{type:Object,default:null},collectionKey:{type:String,default:"collection"},typeCacheKey:{type:String,default:"types"},typeKey:{type:String,default:"type",required:!1},behaviorKey:{type:String,default:"behavior",required:!1},dataLoader:{type:Function,default:null}},data:()=>({items:[],types:null,ready:!1}),watch:{filterArgs(e){this.refreshList(e)}},computed:{loaderObject(){return"string"==typeof this.loader?this.entityLoader(this.loader):this.loader}},created(){this.refreshList()},methods:{refreshList(e=this.filterArgs){this.$emit("refresh",e),this.ready=!1,this.items=[],this.types=null;let t=null;return(t=(t=this.loaderObject.hasTypes()?this.loaderObject.cached(this.typeCacheKey).then(t=>(this.types=t,this.loaderObject.getAll(e))):this.dataLoader?this.dataLoader(this.loaderObject,e):this.loaderObject.getAll(e)).then(e=>(this.$emit("dataloaded",e),{items:e[this.collectionKey]||[],types:this.types,setItems:e=>{this.items=e,this.ready=!0,this.$emit("load",e)}}))).catch(t=>{t.response&&401===t.response.status&&this.$emit("mustlogin",()=>this.refreshList(e))}),t=this.handler?t.then(this.handler):t.then(e=>{e.setItems(e.items)})},getItemType(e){return Array.isArray(this.types)?this.entityTypeFromList(this.types,e[this.typeKey],this.behaviorKey?e[this.behaviorKey]:null,this.typeKey,this.behaviorKey||null):null}}},void 0,!1);var de=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="EntityChangeTitleDialog.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-dialog",e._b({attrs:{persistent:""},model:{value:e.showDialog,callback:function(t){e.showDialog=t},expression:"showDialog"}},"v-dialog",e.$attrs,!1),[i("v-card",[i("v-card-title",{staticClass:"headline"},[e._v("\n            "+e._s(e.$intl.translate(e.title))+"\n        ")]),e._v(" "),e.processingMode?i("v-card-text",[i("v-progress-linear",{attrs:{indeterminate:""}})],1):i("v-card-text",[i("v-text-field",{attrs:{label:e.$intl.translate(e.titleLabel),"error-messages":null===e.error?void 0:[e.error],required:""},model:{value:e.itemTitle,callback:function(t){e.itemTitle=t},expression:"itemTitle"}})],1),e._v(" "),i("v-card-actions",{directives:[{name:"show",rawName:"v-show",value:!e.processingMode,expression:"!processingMode"}]},[i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"secondary",flat:"",disabled:e.processingMode},nativeOn:{click:function(t){return e.cancelDialog(t)}}},[e._v("\n                "+e._s(e.$intl.translate({text:"Cancel",key:"common.cancel"}))+"\n            ")]),e._v(" "),i("v-btn",{attrs:{color:"primary",flat:"",disabled:e.saveDisabled},nativeOn:{click:function(t){return e.confirmDialog(t)}}},[e._v("\n                "+e._s(e.$intl.translate({text:"Save",key:"common.save"}))+"\n            ")])],1)],1)],1)},staticRenderFns:[]},0,{name:"entity-change-title-dialog",props:{title:{type:[Object,String],default:()=>({text:"Change title",key:"common.changeTitle"})},titleLabel:{type:[Object,String],default:()=>({text:"Title",key:"common.titleLabel"})},loader:{type:[String,G],required:!0},item:{type:Object,required:!0},showDialog:{type:Boolean,required:!0}},data:()=>({processingMode:!1,itemTitle:null,error:null}),watch:{showDialog(e){e&&(this.processingMode=!1,this.error=null,this.itemTitle=this.item.title)}},computed:{saveDisabled(){return this.processingMode||this.itemTitle===this.item.title},loaderObject(){return"string"==typeof this.loader?E.get(this.loader):this.loader}},methods:{cancelDialog(){this.$emit("update:showDialog",!1)},confirmDialog(){this.processingMode=!0,this.loaderObject.update(this.item.id,{title:this.itemTitle}).then(()=>{this.$emit("update:showDialog",!1),this.$emit("changed",this.item,this.itemTitle)}).catch(e=>{e.response&&401===e.response.status?this.$emit("mustlogin",()=>{this.confirmDialog()}):(this.processingMode=!1,this.error=e.toString())})},onRouteLeave(e){return!this.showDialog||!this.processingMode&&(this.cancelDialog(),!1)}}},void 0,!1);var he=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="EntityDeleteDialog.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-dialog",e._b({attrs:{persistent:""},model:{value:e.showDialog,callback:function(t){e.showDialog=t},expression:"showDialog"}},"v-dialog",e.$attrs,!1),[i("v-card",[i("v-card-title",{staticClass:"headline"},[e._v(e._s(e.$intl.translate(e.title)))]),e._v(" "),e.deleteMode?i("v-card-text",[i("v-progress-linear",{attrs:{indeterminate:""}})],1):i("v-card-text",[null!==e.error?i("div",{staticClass:"red--text"},[i("v-icon",{attrs:{color:"red"}},[e._v("warning")]),e._v(" "+e._s(e.error))],1):[e._v("\n                "+e._s(e.$intl.translate(e.message))+"\n            ")]],2),e._v(" "),i("v-card-actions",{directives:[{name:"show",rawName:"v-show",value:!e.deleteMode,expression:"!deleteMode"}]},[i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"secondary",flat:"",disabled:e.deleteMode},nativeOn:{click:function(t){return e.cancelDialog(t)}}},[e._v("\n                "+e._s(e.$intl.translate({text:"Cancel",key:"common.cancel"}))+"\n            ")]),e._v(" "),i("v-btn",{attrs:{color:"red",flat:"",disabled:e.deleteMode},nativeOn:{click:function(t){return e.confirmDialog(t)}}},[e._v("\n                "+e._s(e.$intl.translate({text:"Delete",key:"common.delete"}))+"\n            ")])],1)],1)],1)},staticRenderFns:[]},0,{name:"entity-delete-dialog",props:{title:{type:[Object,String],default:()=>({text:"Delete item",key:"common.deleteItem"})},message:{type:[Object,String],default:()=>({text:"Are you sure you want to delete this item?",key:"common.deleteItemMessage"})},loader:{type:[String,G],required:!0},item:{type:Object,required:!0},showDialog:{type:Boolean,required:!0}},data:()=>({deleteMode:!1,error:null}),watch:{showDialog(e){e&&(this.error=null,this.deleteMode=!1)}},computed:{loaderObject(){return"string"==typeof this.loader?E.get(this.loader):this.loader}},methods:{cancelDialog(){this.$emit("update:showDialog",!1)},confirmDialog(){this.deleteMode=!0,this.error=null,this.loaderObject.delete(this.item.id).then(()=>{this.$emit("update:showDialog",!1),this.$emit("delete",this.item)}).catch(e=>{e.response&&401===e.response.status?this.$emit("mustlogin",()=>{this.confirmDialog()}):(this.error=e.toString(),this.deleteMode=!1)})},onRouteLeave(e){return!this.showDialog||!this.processingMode&&(this.cancelDialog(),!1)}}},void 0,!1);var pe=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="ContextMenu.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-menu",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{"position-x":e.x,"position-y":e.y},model:{value:e.contextMenu,callback:function(t){e.contextMenu=t},expression:"contextMenu"}},[null!==e.item?i("v-list",[e._t("default"),e._v(" "),e.showTitle?[i("v-list-tile",{attrs:{disabled:e.isTitleDisabled},on:{click:function(t){t.stopPropagation(),e.contextMenu=!1,e.showTitleDialog=!0}}},[i("v-list-tile-avatar",[i("v-icon",[e._v("title")])],1),e._v(" "),i("v-list-tile-content",[i("v-list-tile-title",[e._v("\n                        "+e._s(e.$intl.translate({text:"Change title",key:"common.changeTitle"}))+"\n                    ")])],1),e._v(" "),i("v-list-tile-action",[i("entity-change-title-dialog",{ref:"titleDialog",attrs:{"show-dialog":e.showTitleDialog,item:e.item,loader:e.loader,"max-width":"300"},on:{"update:showDialog":function(t){e.showTitleDialog=t},changed:e.onTitleChanged,mustlogin:function(t){e.$emit("mustlogin",t)}}})],1)],1)]:e._e(),e._v(" "),e.showDelete?[i("v-divider"),e._v(" "),i("v-list-tile",{attrs:{disabled:e.isDeleteDisabled},on:{click:function(t){t.stopPropagation(),e.contextMenu=!1,e.showDeleteDialog=!0}}},[i("v-list-tile-avatar",[i("v-icon",[e._v("delete")])],1),e._v(" "),i("v-list-tile-content",[i("v-list-tile-title",[e._v("\n                        "+e._s(e.$intl.translate({text:"Delete",key:"common.delete"}))+"\n                    ")])],1),e._v(" "),i("v-list-tile-action",[i("entity-delete-dialog",{ref:"deleteDialog",attrs:{"show-dialog":e.showDeleteDialog,item:e.item,loader:e.loader,"max-width":"300"},on:{"update:showDialog":function(t){e.showDeleteDialog=t},delete:e.onDelete,mustlogin:function(t){e.$emit("mustlogin",t)}}})],1)],1)]:e._e()],2):e._e()],1)},staticRenderFns:[]},0,{components:{EntityChangeTitleDialog:de,EntityDeleteDialog:he},data:()=>({contextMenu:!1,showTitleDialog:!1,showDeleteDialog:!1,item:null,x:0,y:0}),props:{showTitle:{type:Boolean,default:!0},isTitleDisabled:{type:Boolean,default:!0},showDelete:{type:Boolean,default:!0},isDeleteDisabled:{type:Boolean,default:!0},loader:{type:Object,required:!0}},methods:{show(e,t){this.x=e.x,this.y=e.y,this.item=t||null,this.contextMenu=!0},onTitleChanged(e,t){this.$emit("titlechanged",e,t)},onDelete(e){this.$emit("delete",e)},onRouteLeave(e){return!(this.showTitle&&!e(this.$refs.titleDialog))&&(!(this.showDelete&&!e(this.$refs.deleteDialog))&&(this.contextMenu=!1,!0))}}},void 0,!1);var ge=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="EntityList.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("entity-list-template",e._b({ref:"list",attrs:{"two-line":"",loader:e.loader,handler:e.handler,filterArgs:e.searchData},on:{refresh:function(t){e.$emit("refresh",t)},load:function(t){e.$emit("load",t)},dataloaded:function(t){e.$emit("dataloaded",t)},mustlogin:function(t){e.$emit("mustlogin",t)}},scopedSlots:e._u([{key:"item",fn:function(t){var s=t.item,n=t.type;return[t.index>0?i("v-divider"):e._e(),e._v(" "),i("v-list-tile",{key:s.id,on:{click:function(t){e.showContextMenu(s,n,t)}}},[e.hasIcon?i("v-list-tile-avatar",{staticClass:"avatar--tile"},[e._t("item-avatar",[s.icon?i("image-icon",{attrs:{squared:e.squaredIcon,src:s.icon}}):e._e()],{item:s,type:n,loader:e.loaderObject})],2):e._e(),e._v(" "),i("v-list-tile-content",[e._t("item-text",[i("v-list-tile-title",[e._v(e._s(s.title))]),e._v(" "),null!==n?i("v-list-tile-sub-title",[e._v("\n                        "+e._s(n.title)+"\n                        "),i("small",[e._v("("+e._s(s.behavior?s.type+":"+s.behavior:s.type)+")")])]):e._e()],{item:s,type:n,loader:e.loaderObject})],2),e._v(" "),i("v-list-tile-action",[i("v-btn",{attrs:{icon:"",ripple:""},on:{click:function(t){e.showContextMenu(s,n,t)}}},[i("v-icon",[e._v("more_vert")])],1)],1)],1)]}}])},"entity-list-template",e.$attrs,!1),[i("context-menu",{ref:"contextMenu",attrs:{loader:e.loaderObject,"show-title":!1!==e.editableTitle,"show-delete":!1!==e.deletable,"is-title-disabled":!e.isTitleEditable,"is-delete-disabled":!e.isDeletable},on:{titlechanged:e.onTitleChanged,delete:e.onDelete,mustlogin:function(t){e.$emit("mustlogin",t)}}},[null!==e.currentItem?e._t("item-actions",null,{item:e.currentItem,type:e.currentItemType,loader:e.loaderObject}):e._e()],2),e._v(" "),e._t("default")],2)},staticRenderFns:[]},0,{name:"entity-list",components:{ContextMenu:pe,EntityDeleteDialog:he,EntityChangeTitleDialog:de,ImageIcon:b,EntityListTemplate:ue},mixins:[H],props:{loader:{type:[Object,String],required:!0},handler:{type:Function,default:null},deletable:{type:[Boolean,String,Array],default:!1},editableTitle:{type:[Boolean,String,Array],default:!1},hasIcon:{type:Boolean,default:!0},page:{type:Number,default:1},rows:{type:Number,default:30},filterArgs:{type:Object,default:()=>({})},squaredIcon:{type:Boolean,default:!1}},data:()=>({currentItem:null,currentItemType:null}),methods:{showContextMenu(e,t,i){this.currentItem=e,this.currentItemType=t,this.$refs.contextMenu.show(i,e)},onTitleChanged(e,t){this.$set(e,"title",t)},onDelete(e){const t=this.$refs.list.items,i=t.indexOf(e);i>-1&&(t.splice(i,1),this.$emit("itemdeleted",{item:e,list:t}))},refreshList(e){const t=this.$refs.list;t.refreshList(void 0===e?t.filterArgs:e)},onRouteLeave(e){return!!e(this.$refs.contextMenu)&&e(this.$refs.list)}},computed:{searchData(){return{...this.filterArgs,page:this.page,rows:this.rows}},loaderObject(){return"string"==typeof this.loader?this.entityLoader(this.loader):this.loader},isDeletable(){return"boolean"==typeof this.deletable?this.deletable:this.$user.hasPermission(this.deletable)},isTitleEditable(){return"boolean"==typeof this.editableTitle?this.editableTitle:this.$user.hasPermission(this.editableTitle)}}},void 0,!1),ye={data:()=>({listLoaded:!1,totalItems:0,lastPage:0}),methods:{onListDataLoaded(e){this.totalItems=e.total,this.lastPage=e.rows>0?Math.ceil(e.total/e.rows):0},onListLoaded(){this.listLoaded=!0},onListRefresh(){this.listLoaded=!1}}};var me=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="EntityListForm.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("app-page",{ref:"page",attrs:{title:e.pageTitle,back:e.back}},[i("template",{slot:"toolbar"},[e.refreshButton?i("v-btn",{attrs:{dark:"",icon:""},on:{click:function(t){t.stopPropagation(),e.$refs.list&&e.$refs.list.refreshList()}}},[i("v-icon",[e._v(e._s(e.$controlIcon("refresh")))])],1):e._e(),e._v(" "),e.filterForm&&e.filterForm.length?[i("v-dialog",{attrs:{lazy:"","max-width":"500"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[i("v-btn",{attrs:{slot:"activator",dark:"",icon:""},on:{click:function(t){e.makeDialogModel()}},slot:"activator"},[i("v-icon",[e._v(e._s(e.$controlIcon(e.contextIcon)))])],1),e._v(" "),i("block-form",{ref:"filterForm",attrs:{title:"Search...",items:e.filterForm,"submit-button":"Search",options:e.formOptions},on:{submit:function(t){e.filterItems(t)}},scopedSlots:e._u([{key:"default",fn:function(t){return[i("v-btn",{attrs:{flat:""},on:{click:function(t){t.stopPropagation(),e.dialogModel={},e.filterItems(e.dialogModel)}}},[i("v-icon",[e._v("clear")]),e._v("\n                            Reset\n                        ")],1),e._v(" "),i("v-spacer"),e._v(" "),i("v-btn",{attrs:{color:"primary",disabled:t.submitDisabled},on:{click:function(e){e.stopPropagation(),t.submit()}}},[i("v-icon",[e._v("search")]),e._v("\n                            Search\n                        ")],1)]}}]),model:{value:e.dialogModel,callback:function(t){e.dialogModel=t},expression:"dialogModel"}})],1)]:e._e()],2),e._v(" "),i("entity-list",{ref:"list",attrs:{page:e.listPage,loader:e.entity,deletable:e.hasDelete&&e.canDelete,"editable-title":e.hasTitle&&e.canEdit,"has-icon":e.hasIcon,handler:e.loadHandler,"filter-args":e.filters,"collection-key":e.collectionKey,"type-key":e.typeKey,"behavior-key":e.behaviorKey,"type-cache-key":e.typeCacheKey,rows:e.rows,"squared-icon":e.squaredIcon},on:{load:function(t){e.onListLoaded()},refresh:function(t){e.onListRefresh()},dataloaded:function(t){e.onListDataLoadedCheck(t)},itemdeleted:function(t){e.onItemDeletedCheck(t)},mustlogin:function(t){e.doLogin(t)}},scopedSlots:e._u([{key:"item-text",fn:function(t){var s=t.item,n=t.type;return null!=e.customText?[i("v-list-tile-title",{domProps:{innerHTML:e._s(e.getCustomTitle(s,n)||"")}}),e._v(" "),i("v-list-tile-sub-title",{domProps:{innerHTML:e._s(e.getCustomDescription(s,n)||"")}})]:void 0}},{key:"item-actions",fn:function(t){var s=t.item,n=t.type;return e.actions.length>0?e._l(e.actions,function(t){return i("v-list-tile",{key:e.$uniqueObjectId(t),attrs:{to:t.callback?void 0:e.actionHref(t.href,s,n),disabled:!e.canEdit||t.disabled&&t.disabled(s,n)},on:{click:function(i){t.callback&&e.canEdit&&(!t.disabled||!t.disabled(s,n))&&t.callback(s,n)}}},[i("v-list-tile-avatar",[t.icon?i("v-icon",[e._v(e._s(t.icon))]):e._e()],1),e._v(" "),i("v-list-tile-content",[i("v-list-tile-title",{domProps:{innerHTML:e._s(e.actionTitle(t.title,s,n))}})],1),e._v(" "),i("v-list-tile-action",[e._v(" ")])],1)}):void 0}}])}),e._v(" "),e.lastPage>1?i("v-layout",{directives:[{name:"show",rawName:"v-show",value:e.listLoaded,expression:"listLoaded"}],staticClass:"white",attrs:{"align-center":"","justify-center":""}},[i("v-pagination",{attrs:{circle:"",length:e.lastPage,"total-visible":e.visiblePages},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1):e._e(),e._v(" "),i("v-fab-transition",[e.canAdd&&e.listLoaded?i("v-btn",{attrs:{fixed:"",fab:"",bottom:"",right:"",color:"accent",to:e.addHref}},[i("v-icon",[e._v("add")])],1):e._e()],1)],2)},staticRenderFns:[]},0,{components:{EntityList:ge,AppPage:Q},mixins:[ye,H,se,ie,oe,ae],props:{entity:{type:String,required:!0},title:{type:[String,Object],required:!0},back:{type:String,default:"../"},permissions:{type:Object,require:!0},rows:{type:Number,default:30},addHref:{type:String,default:"add.html"},hasTitle:{type:Boolean,default:!0},hasIcon:{type:Boolean,default:!0},hasDelete:{type:Boolean,default:!0},actions:{type:Array,default:()=>[]},idField:{type:String,default:"id"},filterForm:{type:Array,default:null},collectionKey:{type:String,default:"collection"},typeCacheKey:{type:String,default:"types"},typeKey:{type:String,default:"type",required:!1},behaviorKey:{type:String,default:"behavior",required:!1},iconKey:{type:[String,Function],required:!1,default:"icon"},customText:{type:Object,default:null},visiblePages:{type:Number,default:7},squaredIcon:{type:Boolean,default:!1},contextIcon:{type:String,default:"search"},afterDelete:{type:Function,default:null},refreshButton:{type:Boolean,default:!1}},data:()=>({totalLoaded:0,dialog:!1,dialogModel:{}}),watch:{"$route.query"(e){this.dialog&&(this.dialog=!1),e.page?this.page=parseInt(e.page)||1:this.page>1&&(this.page=1)}},computed:{pageTitle(){return this.$intl.translate(this.title,{total:this.totalLoaded,page:this.listPage,last:this.lastPage||1,rows:this.rows},this.totalLoaded,null)},canAdd(){return this.checkPermission(this.permissions.add)},canEdit(){return this.checkPermission(this.permissions.edit)},canDelete(){return this.checkPermission(this.permissions.delete)}},methods:{makeDialogModel(){this.$route&&this.$route.query?(this.dialogModel=this.$clone(this.$route.query),delete this.dialogModel.page):this.dialogModel={}},onListDataLoadedCheck(e){this.totalLoaded=e.total||0,this.onListDataLoaded(e)},onItemDeletedCheck(e){this.afterDelete&&this.afterDelete(e,this),this.onItemDeleted(e)},filterItems(e){this.dialog=!1,this.page=1,this.queryFilters=this.clearFilters(this.$clone(e))},getCustomTitle(e,t){return this.getCustomText(this.customText.title,e,t)},getCustomDescription(e,t){return this.getCustomText(this.customText.description,e,t)},getCustomText(e,t,i){return e?"function"==typeof e?e(t,i,this):t[e]||void 0:null},actionHref(e,t,i){if("function"==typeof e){const s=e(t,i,this);return"string"==typeof s?s:void 0}return e.replace("{id}",t[this.idField])},actionTitle(e,t,i){return"function"==typeof e?e(t,i,this):this.$intl.translate(e,t)},checkPermission(e){return"boolean"==typeof e?e:this.$user.hasPermission(e)},loadHandler(e){if(!this.hasIcon||!this.iconKey)return void e.setItems(e.items);const t="function"==typeof this.iconKey;if(!e.types)return e.items.map(e=>{e.icon=t?this.iconKey(e,this):e[this.iconKey]||null}),void e.setItems(e.items);e.items.map(i=>{const s=this.entityTypeFromList(e.types,i[this.typeKey],this.behaviorKey?i[this.behaviorKey]:null,this.typeKey,this.behaviorKey||null);i.icon=s?t?this.iconKey(s,this):s[this.iconKey]||s.title:(t?this.iconKey(i,this):i[this.iconKey])||null}),e.setItems(e.items)},onRouteLeave(e){return this.dialog?(e(this.$refs.filterForm)&&(this.dialog=!1),!1):e(this.$refs.list)}}},void 0,!1);const Me=["black","dark","light","white","primary","secondary","info","success","warning","danger"],fe=["black","dark","light","white","primary","secondary","info","success","warning","danger"],ve={minimal:{syntax:!1,formula:!1,toolbar:[[{header:[1,2,3,!1]}],[{align:[]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["blockquote","link"],["clean"]]},simple:{syntax:!1,formula:!1,toolbar:[[{header:[1,2,3,4,5,6,!1]}],[{align:[]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{indent:"-1"},{indent:"+1"}],["blockquote","code-block","link","image","video"],["clean"]]},full:{syntax:{highlight:e=>s?s.highlightAuto(e).value:e},formula:!1,toolbar:[[{header:[1,2,3,4,5,6,!1]}],[{align:[]}],["bold","italic","underline","strike",{script:"sub"},{script:"super"}],[{list:"ordered"},{list:"bullet"},{list:"check"}],[{indent:"-1"},{indent:"+1"}],[{color:Me.concat([!1])},{background:fe.concat([!1])}],["blockquote","code-block","link","image","video"],["clean"]]}};!function(e){if(!e)return;const t=(t,i)=>{t=e.import(t);for(let e in i)i.hasOwnProperty(e)&&(t[e]=i[e]);e.register(t,!0)};t("attributors/class/background",{keyName:"bg",whitelist:fe}),t("attributors/class/color",{keyName:"text-color",whitelist:Me}),t("attributors/class/align",{keyName:"text-align"}),t("formats/strike",{tagName:["DEL","S"]}),t("formats/indent",{keyName:"text-indent"}),t("formats/list",{className:"indent-list"}),t("formats/code-block",{className:"hljs"})}(i);var Le=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="QuillEditor.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"quillWrapper"},[i("div",{ref:"quillContainer"}),e._v(" "),e.useCustomImageHandler?i("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:function(t){e.emitImageInfo(t)}}}):e._e()])},staticRenderFns:[]},0,{name:"quill-editor",props:{value:{type:String,required:!1,default:""},placeholder:{type:String,default:"",required:!1},disabled:{type:Boolean,default:!1,required:!1},useCustomImageHandler:{type:Boolean,default:!1,required:!1},editorModules:{type:[Object,String],default:"full",required:!1},editorTheme:{type:String,default:"snow",required:!1}},data:()=>({quill:null,editor:null}),mounted(){let e=ve.full;if(this.editorModules&&(e="string"==typeof this.editorModules?ve.hasOwnProperty(this.editorModules)?ve[this.editorModules]:ve.full:this.editorModules),this.quill=new i(this.$refs.quillContainer,{modules:e,placeholder:this.placeholder,theme:this.editorTheme,readOnly:this.disabled}),this.editor=this.$refs.quillContainer.querySelector(".ql-editor"),this.editor.innerHTML=this.value||"",this.useCustomImageHandler){this.quill.getModule("toolbar").addHandler("image",(e,t)=>{this.$refs.fileInput.click()})}this.quill.on("text-change",()=>{let e=this.editor.innerHTML;"<p><br></p>"===e&&(e=""),this.$emit("input",e)})},watch:{value(e){e===this.editor.innerHTML||this.quill.hasFocus()||(this.editor.innerHTML=e)},disabled(e){this.quill.enable(!e)}},methods:{emitImageInfo(e){let t=e.target.files[0],i=this.quill,s=i.getSelection().index;this.$emit("imageAdded",t,i,s)}}},void 0,!1);var Ne=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="AceEditor.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this.$createElement;return(this._self._c||e)("div",this._b({staticClass:"ace-editor"},"div",this.$attrs,!1))},staticRenderFns:[]},0,{name:"ace-editor",props:{value:{type:String,default:"",required:!1},lang:{type:String,default:"html",required:!1},theme:{type:String,default:"chrome",required:!1},options:{type:Object,default:()=>({minLines:5,maxLines:20,tabSize:2}),required:!1}},data(){return{editor:null,hasSyntaxError:!1,check:()=>{this.hasSyntaxError=this.editor.getSession().getAnnotations().some(e=>"error"===e.type)},onChange:()=>{this.$emit("input",this.editor.getValue())}}},mounted(){const e=this.editor=n.edit(this.$el);e.$blockScrolling=1/0,e.getSession().setMode("ace/mode/"+this.lang),e.setTheme("ace/theme/"+this.theme),e.setOptions(this.options),e.setValue(this.value||"",1),e.on("change",this.onChange),e.on("blur",this.check),e.getSession().on("changeAnnotation",this.check)},beforeDestroy(){const e=this.editor;e.getSession().off("changeAnnotation",this.check),e.off("blur",this.check),e.off("change",this.onChange),e.getSession().destroy(),e.destroy();const t=this.$el;for(;t.firstChild;)t.removeChild(t.firstChild);this.hasSyntaxError=!1,this.editor=null},watch:{theme(e){const t=this.editor;t&&t.setTheme("ace/theme/"+e)},value(e){const t=this.editor;if(!t)return;const i=t.selection.getCursor();t.setValue(e||""),t.clearSelection(),t.gotoLine(i.row+1,i.column)},lang(e){const t=this.editor;t&&t.getSession().setMode("ace/mode/"+e)},options(e){const t=this.editor;t&&t.setOptions(e)},hasSyntaxError(e){this.$emit("syntax-error",e)}}},void 0,!1);var De=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="control.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"my-2"},[i("control-label",{attrs:{text:e.$intl.translate(e.display.title),"has-error":e.allErrors.length>0,required:e.config.required}}),e._v(" "),i("ace-editor",{ref:"editor",attrs:{options:e.config.editor,lang:e.config.lang},on:{input:function(t){e.validate()},"syntax-error":function(t){e.hasSyntaxError=t}},model:{value:e.model[e.name],callback:function(t){e.$set(e.model,e.name,t)},expression:"model[name]"}}),e._v(" "),i("block-error",{attrs:{error:e.allErrors.length>0?e.allErrors[0]:void 0}})],1)},staticRenderFns:[]},0,{components:{AceEditor:Ne,BlockError:r.BlockError,ControlLabel:r.ControlLabel},mixins:[t.JsonFormElementMixin],data:()=>({hasSyntaxError:!1}),created(){this.addValidation("syntax",()=>!this.hasSyntaxError,{text:"Syntax error",key:"validation.code-syntax"})},beforeDestroy(){this.addValidation("syntax",null)}},void 0,!1);De.install=function(){t.JsonForm.addControl("code",new t.StringControlParser(De))};var we=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="control.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"my-2"},[i("control-label",{attrs:{text:e.$intl.translate(e.display.title),"has-error":e.allErrors.length>0,required:e.config.required}}),e._v(" "),i("quill-editor",{attrs:{placeholder:e.$intl.translate(e.display.placeholder),"editor-modules":e.config.mode},model:{value:e.model[e.name],callback:function(t){e.$set(e.model,e.name,t)},expression:"model[name]"}}),e._v(" "),i("block-error",{attrs:{error:e.allErrors.length>0?e.allErrors[0]:void 0}})],1)},staticRenderFns:[]},0,{mixins:[t.JsonFormElementMixin],components:{ControlLabel:r.ControlLabel,QuillEditor:Le,BlockError:r.BlockError}},void 0,!1);we.install=function(){t.JsonForm.addControl("richtext",new t.StringControlParser(we))};var je=function(e,t,i,s,n,r,o,a){const l=("function"==typeof i?i.options:i)||{};return l.__file="control.vue",l.render||(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0,n&&(l.functional=!0)),l._scopeId=s,l}({render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"my-2"},[i("control-label",{attrs:{text:e.$intl.translate(e.display.title),"has-error":e.allErrors.length>0,required:e.config.required}}),e._v(" "),i("ace-editor",{ref:"editor",attrs:{lang:"json"},on:{input:function(t){e.onCode(t)},"syntax-error":function(t){e.hasSyntaxError=t}},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}}),e._v(" "),i("block-error",{attrs:{error:e.allErrors.length>0?e.allErrors[0]:void 0}})],1)},staticRenderFns:[]},0,{components:{AceEditor:Ne,BlockError:r.BlockError,ControlLabel:r.ControlLabel},mixins:[t.JsonFormElementMixin],data:()=>({code:null,hasSyntaxError:!1}),created(){this.code=JSON.stringify(this.modelProxy,null,2),this.addValidation("syntax",()=>!this.hasSyntaxError,{text:"Syntax error",key:"validation.code-syntax"})},beforeDestroy(){this.addValidation("syntax",null)},methods:{onCode(e){let t=null;try{t=JSON.parse(e)}catch(e){return this.hasSyntaxError=!0,void this.validate()}Array.isArray(t)?(this.hasSyntaxError=!1,this.$set(this.model,this.name,t)):this.hasSyntaxError=!0,this.validate()}}},void 0,!1);je.install=function(){t.JsonForm.addControl("json-form-controls",new t.ArrayControlParser(je))};const xe={render:e=>e("router-view")};var Te={props:{loaders:{type:Object,required:!0},user:{type:Object,required:!0},router:{type:o,required:!0},options:{type:Object,default:()=>({})}},data:()=>({extensions:{},vendors:{},vendorRoutes:{}}),render(e){return e(U,{props:{user:this.user,options:this.options}})},methods:{setOptions(e){if(e&&"object"==typeof e)for(const t in e)e.hasOwnProperty(t)&&this.setOption(t,e[t])},setOption(e,t){return this.$set(this.options,e,t),this},deleteOption(e){return this.$delete(this.options,e),this},register(e,t=[],i=null){const s=[];"string"==typeof e&&(e={name:e,title:e}),this.vendors[e.name]=e;const n=t.map(t=>(null===i&&(i=t.name),this._mapExtension(s,t,e.name)));return this.extensions.hasOwnProperty(e.name)||(this.extensions[e.name]=[]),this.extensions[e.name]=this.extensions[e.name].concat(n),s.length>0&&(this.vendorRoutes[e.name]=!0,this.router.addRoutes([this._vendorRoute(e.name,i,s)])),this},registerExtension(e,t){const i=[],s=this._mapExtension(i,t,e);return i.length>0&&this.vendorRoutes[e]&&this.router.addRoutes([this._vendorRoute(e,null,i)]),this.extensions.hasOwnProperty(e)||(this.extensions[e]=[]),this.extensions[e].push(s),s},getAllVendors(){return this.vendors},getVendor(e){return this.vendors[e]},getAllExtensions(){return this.extensions},getAllVendorExtensions(e){return this.extensions.hasOwnProperty(e)?this.extensions[e]:null},getVendorExtension(e,t){const i=this.getAllVendorExtensions(e);if(!i)return null;for(let e=0;e<i.length;e++)if(t===i[e].name)return i[e];return null},_mapExtension(e,t,i){if(t.routes&&Array.isArray(t.routes)){let i=t.defaultRoute||null;null===i&&t.routes.some(e=>"string"==typeof e.path&&(i=e.path,!0)),e.push(this._extensionRoute(t.name,i,t.routes))}return{vendor:i,name:t.name||null,title:t.title||null,description:t.description||null,icon:t.icon||null,permissions:t.permissions||[],menu:t.menu||[]}},_vendorRoute:(e,t,i=[],s={})=>(i=[{path:"",redirect:()=>({path:t,params:{vendor:e,extension:t}})}].concat(i),{path:"/:vendor("+e+")",alias:"/"+e,component:xe,children:i,...s}),_extensionPermissionHook(e,t,i){const s=this.getVendorExtension(e.params.vendor,e.params.extension);s&&!this.user.hasPermission(s.permissions)?i(!1):i()},_extensionRoute(e,t,i=[],s={}){return i=[{path:"",redirect:i=>({path:t,params:{vendor:i.params.vendor,extension:e}})}].concat(i),{path:":extension("+e+")",alias:e,component:V,props:this._extensionProps,beforeEnter:this._extensionPermissionHook,children:i,...s}},_extensionProps(e){return{appInfo:{vendor:e.params.vendor||null,extension:e.params.extension||null,app:this,user:this.user}}}}};const _e=new o,Ie=new a({router:_e,propsData:{user:Z,router:_e,loaders:E},...Te});_e.addRoutes([{path:"/",component:B,props:()=>({app:Ie})}]);class Ce{constructor(){this._registry={},this._cache={}}async load(e){let t=!1,i=Date.now();if(this._cache.hasOwnProperty(e)){let s=this._cache[e];if(0===s.ttl||s.ttl>i)return s.data;t=!0}if(!t&&!this._registry.hasOwnProperty(e))throw new Error('Unknown cache key "'+e+'"');let s=this._registry[e],n=s.loader,r=0===s.ttl?0:s.ttl+i,o=await n();return this._cache[e]={data:o,ttl:r},o}register(e,t,i=0){i=i<=0?0:1e3*i,this._registry[e]={loader:t,ttl:i}}isRegistered(e){return this._registry.hasOwnProperty(e)}clear(e){delete this._cache[e]}clearAll(){this._cache={}}}const be=new Ce;a.use(l),a.use(o),a.component(b.name,b),a.component(N.name,N),a.component(A.name,A),a.use(c),a.use(u),a.component(r.BlockForm.name,r.BlockForm),a.component(r.StepperForm.name,r.StepperForm),a.component(r.DialogForms.name,r.DialogForms),a.use(m),a.use(g),a.use(O),a.use(k),a.use(De),a.use(we),a.use(je),a.prototype.$app=Ie,a.prototype.$user=Z,e.App=Ie,e.Router=_e,e.Loaders=E,e.permissionHook=X,e.permissionRoute=ee,e.onRouteLeave=te,e.entityCreateRoute=function(e,t,i=[],s={}){return ee({path:e,component:le,props:e=>"function"==typeof t?t(e):t,...s},i)},e.entityEditRoute=function(e,t,i=[],s="entityInstanceId",n={},r="[a-zA-Z0-9-:]{3,32}"){let o=":"+s+"("+r+")";return null!=e&&""!==e&&(o+="/"+e),ee({path:o,component:ce,props:e=>"function"==typeof t?t(e,e.params[s]):{...t,id:e.params[s]},...n},i)},e.entityListRoute=function(e,t,i=[],s={}){return ee({path:e,component:me,props:e=>"function"==typeof t?t(e):t,...s},i)},e.AppLayout=Y,e.AppMenu=P,e.AppExtensions=$,e.AppUser=F,e.AppRoot=U,e.AppToolbar=q,e.AppPage=Q,e.AppDashboard=B,e.AppNotifier=R,e.AppExtensionRoute=V,e.EntityChangeTitleDialog=de,e.EntityDeleteDialog=he,e.QuillEditor=Le,e.AceEditor=Ne,e.EntityList=ge,e.EntityListTemplate=ue,e.EntityListLoadMixin=ye,e.EntityListContextMenu=pe,e.LetterAvatar=N,e.ImageIcon=b,e.ContentLoader=A,e.EntityCreateForm=le,e.EntityEditForm=ce,e.EntityListForm=me,e.CodeControl=De,e.RichtextControl=we,e.JsonFormControlsControl=je,e.EntityTypeParser=S,e.EntityTypeControl=O,e.EntityInstanceParser=z,e.EntityInstanceControl=k,e.ExtendableError=D,e.ServerError=w,e.BaseLoader=K,e.DataLoader=G,e.CacheLoader=Ce,e.CachedDataLoader=class extends G{constructor(e,t,i=!0,s={},n=300){super(e,i),this._key=t,s={types:()=>this.getTypes(),instances:()=>this.getAll(),...s};for(const e in s)s.hasOwnProperty(e)&&"function"==typeof s[e]&&be.register(t+"/"+e,s[e],n)}create(e){return super.create(e).then(e=>this._clearCache(e))}update(e,t){return super.update(e,t).then(e=>this._clearCache(e))}delete(e){return super.delete(e).then(e=>this._clearCache(e))}cached(e){return be.load(this._key+"/"+e)}_clearCache(e){return be.clear(this._key+"/instances"),e}static cacheStorage(){return be}},e.Requestor=_,e.EntityMixin=H,e.CloseDialogsBeforeLeave=ie,e.PagerMixin=se,e.PageNotifier=ne,e.ServerErrorMixin=re,e.LoginMixin=oe,e.FormMixin=ae,e.DOMPortalDirective=g,e.DocumentTitleDirective=m,Object.defineProperty(e,"__esModule",{value:!0})});
